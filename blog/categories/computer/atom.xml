<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Computer | rcmdnk's blog]]></title>
  <link href="http://rcmdnk.github.io/blog/categories/computer/atom.xml" rel="self"/>
  <link href="http://rcmdnk.github.io/"/>
  <updated>2013-08-29T18:25:55+02:00</updated>
  <id>http://rcmdnk.github.io/</id>
  <author>
    <name><![CDATA[rcmdnk]]></name>
    <email><![CDATA[rdmdnk@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Group Policy Clientサービスに接続できませんでした。]]></title>
    <link href="http://rcmdnk.github.io/blog/2013/08/27/computer-windows/"/>
    <updated>2013-08-27T21:55:00+02:00</updated>
    <id>http://rcmdnk.github.io/blog/2013/08/27/computer-windows</id>
    <content type="html"><![CDATA[<p>Windows Update後、題名の様なエラーがでてログイン出来ず。</p>

<!-- more -->


<p>Windows7でWindows Updateした後、再起動した時、
ログイン画面までは普通に行ったのに、
ログインしようとしたら</p>

<pre><code>Group Policy Clientサービスに接続できませんでした。
システム管理者に連絡してください。
</code></pre>

<p>と出て、強制ログアウトする状態に。
この際ログインしようとしたのは、管理者権限が無いユーザーでした。</p>

<p>試しにセーフモードで立ち上げてみたら</p>

<pre><code>The user name or password is incorrect.
</code></pre>

<p>というエラーが途中で出ましたが、その後ログイン画面に行き、
普通のログインの様な画面に移行後ログインするような状態に。</p>

<p>取り敢えず一旦再起動しなおして、管理者アカウントでログインすると、
ログインは出来たのですが、</p>

<pre><code>Windowsサービスに接続できませんでした。
Group Policy Clientサービスに接続できませんでした。
このため、標準ユーザーはこのシステムにログオンできません。
管理者ユーザーは、システムイベントログを参照して、このサービスが応答しなかった原因を確認できます。
</code></pre>

<p>というエラーメッセージが。
Windows全般的にそうですが、(知識がないので。。。)エラーログを見ても余りよく分からないので、適当にググってみると</p>

<blockquote><p><a href="http://bit.ly/16ODJZ6">レジストリの修正する</a></p></blockquote>

<p>とか</p>

<blockquote><p><a href="http://bit.ly/1fhbhRb">ユーザープロファイルを削除してみるとか</a></p></blockquote>

<p>とかありましたが、ちょっと大変そうなので、取り敢えず
システムの復元を試すことに。</p>

<p>で、結果的にはUpdate前の復元ポイントまで戻したら問題なく治りました。
その後Updateを適用しても大丈夫そうです。</p>

<p>何が問題だったんだろうか。。。？</p>

<hr />
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[KDriveのサービス終了でオンラインストレージ使用について考えてみる]]></title>
    <link href="http://rcmdnk.github.io/blog/2013/08/23/computer/"/>
    <updated>2013-08-23T09:43:00+02:00</updated>
    <id>http://rcmdnk.github.io/blog/2013/08/23/computer</id>
    <content type="html"><![CDATA[<p>オンラインストレージサービスのKDriveが個人向けサービスを終了するようです。</p>

<!-- more -->


<p><br class="clearBoth">

<h1>Contents</h1>
{:TOC}

<script type="text/javascript"><!--
google_ad_client = "ca-pub-3802317723662375";
/* imgRectMid */
google_ad_slot = "9043394444";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>




</p>

<h1 id="KDrive終了">KDrive終了</h1>

<p>KDriveはアカウント作るだけで40GB無料で使え、さらにログイン等の簡単な作業だけで
50GBまで増えるオンラインストレージサービスなので、
一応アカウント作って、あまり重要でないけど
外から見たくなったら見えたら嬉しい、的な物を
メインのPCのみでバックアップも兼ねて同期して使ってました。</p>

<p>それがサービスを終了するようです。
<a href="http://info.kingsoft.jp/company/information/2013/08/20130823.html">キングソフトからのお知らせ</a>
によると、2013/9/2に新規アカウント停止、9/25日には無料版はアップロード停止、
さらに2014/2/28にはログインもできなくなる模様。
有料版でも2014/8/29で全て終了するみたいです。</p>

<p>法人向けサービスは続くみたいですが、やはり、50GBを簡単に無料で提供する、と言うのは
なかなか成り立つものではないのでしょうかね。
今やオンラインストレージサービスはいたるところにあるので、
有料で使うくらいなら他を使うし、無料で取り敢えず50GBだけ使ってるって人が
多かったんでしょうか？
ちょっと前に30GB無料とかやってたNドライブも<a href="http://ndrive.naver.jp/notice?page=1&amp;docId=4005">終了のアナウンス</a>出してましたが。</p>

<h1 id="乗り換え先">乗り換え先</h1>

<p>乗り換え先としては時々キャンペーンで50GBの振る舞いをしてた時に取った
Boxかな、と思って久々に開いてみたら削除された。。。
<a href="https://app.box.com/legal_text/tos">120日間ノーアクセスだと消されるようですね</a>。
いずれにしろ無料だと最大ファイルサイズが250MBなので使い道が限られるため、
あまり使い勝手が良くないかもしれません。</p>

<p>探してみたら色々ありすぎて大変な状況ですが、同じくらいの量を無料で、となると
<a href="http://www.adrive.com/">ADrive</a>辺りですが、無料だとデスクトップクライアントも
使えないので自動で同期したりすることは出来なそうです。</p>

<p>それであれば、同様にMEAGAUPLOADの後継？の<a href="https://mega.co.nz/">Mega</a>
なんかも50GB使えますが、流石に微妙な所。</p>

<p>差し当たり同じ様な量を同じように使える感じの所はない感じです。
ので、ちょっと別の方向で考えようかな、と。</p>

<h1 id="メインで使っているオンラインストレージ">メインで使っているオンラインストレージ</h1>

<div class="nailthumb-container title-thumb">
  <a href="https://www.dropbox.com/" rel="nofollow" target="_blank" >
    <img src="/images/WinApp/Dropbox.png" alt="" title="" >
  </a>
</div>


<p>今、オンラインストレージはDropboxをメインに使っていて、これは大分無料でも
容量が増えたので手持ちのマシンで色々共有するのに使っています。
20GB程度まで増えてるので、それなりに必要な物は充分共有できてます。</p>

<p>ですがそれでも20GB程度なので、ちょっと大きな物を取り敢えず入れておこう、というわけにはいきません。</p>

<p>SugerSyncやGoogle Drive等色々使えば増えますが、細切れで入れてくのも
管理が面倒になるので避けたいところです。(SugerSyncはあまり容量が増えてないので。。。)</p>

<h1 id="人のサーバーを通さないオンライン共有">人のサーバーを通さないオンライン共有</h1>

<p>上に挙げた物は<code>オンラインストレージ</code>で、サーバーを借りて
ファイルを入れておき、そこと手元のマシンで同期したりダウンロードしたり
する感じですが、最近、そのような環境をオンラインサーバーを通さず
に作れる様な物も出てきました。</p>

<h2 id="AeroFS">AeroFS</h2>

<div class="nailthumb-container title-thumb">
  <a href="https://www.aerofs.com/" rel="nofollow" target="_blank" >
   <img class="left" src="/images/WinApp/AeroFS.png" >
  </a>
</div>


<p><a href="https://aerofs.com/">AeroFS</a>はDropboxの様なファイル同期を
サーバーを通さず行います。
前にあったWindows Live Meshみたいなものです。
ちょっと前までベータ版で招待制でしたが、今は正式版ですぐに登録できます。</p>

<p>登録すると、各マシンからのアクセス等、ユーザー管理はAeroFSで行いますが、
ファイル自体はP2Pで受け渡しが行われるので完全にPrivateです。
サーバーに置いておくわけではないので、Google Driveで騒ぎになった
所有権の問題も全く関係ありえません。</p>

<p>一方、サーバー通さないので、例えば2つのマシンで共有したい時は
両方が同時に起動してないと同期できません。
一台ファイルサーバー的に常時起動しておくマシンがあればDropboxに限りなく近く
使えると思います。</p>

<p>サーバーを通さないので、基本的に自分の持っているディスク分だけいくらでも
共有可能で制限はありません。</p>

<p>履歴などの機能もありますが、これもローカルディスクに作るので、その分
ディスクは圧迫しますが、逆にディスクさえ充分あればいくらでもできます。</p>

<p>また、Share機能もあって、ファイルをShare設定しておけば
他の人ともAeroFSでフォルダを共有できる用にもなります。</p>

<p>今は一部のPCで比較的大きなファイルの共有をするのに使っています。</p>

<p>ただ、これだとWebインターフェースからファイルにはアクセス出来ないので、
AeroFSのアプリケーションを入れてないとファイルにアクセス出来ません。
それからiOS用のアプリがないので、現状iPhone等からアクセスする手段はありません。
Android版はあるみたいです。</p>

<p>ですので、完全に同期、共有化のためのシステムな感じです。</p>

<h2 id="ownCloud">ownCloud</h2>

<div class="nailthumb-container title-thumb">
  <a href="https://www.aerofs.com/" rel="nofollow" target="_blank" >
    <img class="left" src="/images/WinApp/owncloud.png" >
  </a>
</div>


<p><a href="http://owncloud.org/">ownCloud</a>はAeroFSと違いDropboxのような環境を
自前で作ってしまおう、と言った形のシステムです。
サーバーを自分で作って、そこにクライアントからアクセスします。</p>

<p>ですので、この場合には1台常時起動しているシステムが必須です。
AeroFSの場合は、例えば3台持ってたらそのうち2台ずつでも起動していれば
結果的に全て同期できますが、ownCloudではサーバーを動かしておくための
マシンが必要です。</p>

<p>その代わり、webサーバーを立ち上げて、Dropboxの様にWebアクセスも出来る様になります。
なので、完全にDropboxのようなオンラインストレージサービスを自分で
持つことが出来ます。ユーザー管理等も勿論自前なので、
完全に独立したPrivateな環境を作ることが出来ます。</p>

<p>前に見た時はサーバーがLinux専用で、自分で常時起動しておけるLinuxマシンが無かったので
試してませんでしたが、今はWindowsやMac用もあるみたいなので、そのうち試して見たいと思ってます。</p>

<p>サーバーにするのに固定IPが必要ですが、<a href="http://www.noip.com/">No-IP</a>
の様なサービスを使えば、ドメインを貰えて、そのドメインとマシンのIP
を定期的に同期し続ける事が出来るので、 擬似的に固定IPを使える様な形になり、
無理に固定IPサービスをプロバイダに頼まなくても使えます。(でないと無駄に1000円くらいするので…)</p>

<p>ownCloudで検索した時に<a href="http://owncloud.com/">http://owncloud.com/</a>も出てきましたが、
orgの方が元々立ち上げられたコミュニティのためのページで、
comの方はowonCloudを使ったサービスを提供する企業のページ、ということみたいです<sup id='fnref:1'><a href='#fn:1' rel='footnote'>1</a></sup><sup id='fnref:2'><a href='#fn:2' rel='footnote'>2</a></sup>。</p>

<p>ちなみに日本でもビーグッド・テクノロジーと言う会社が<a href="http://owncloud.jp/">http://owncloud.jp/</a>というドメインを取得してサポート等を提供しているみたいです。</p>

<p>ownCloudはかなり活発に開発が行われてて大分使いやすそうなので、
DropboxやAeroFSで使ってる部分はそのままにして、
KDriveで行っていた作業的なものは、1台古いPCをファイルサーバーにしてしまって
ownCloudで行おうかな、と思ってます。
速度の問題さえ無ければDropbox分も移行しても良いかもしれません。
ハードディスクも大分安くなったので、そのサーバーで適当にバックアップを
取っておけば便利ですし。
完全にサーバー化するならLinuxにしておいた方が便利かな、とも思います。
そのうちやろう…</p>

<hr />

<p><div class="footnotes">
	<ol>
		<li id='fn:1'><p><a href="http://forum.owncloud.org/viewtopic.php?f=17&amp;t=8594">Difference .ORG and .COM</a>
  <a href='#fnref:1' rev='footnote'>↩</a></p>
</li><li id='fn:2'><p><a href="http://sourceforge.jp/magazine/11/12/15/0513233">オンラインストレージソフトウェアの商用サービスを提供する「ownCloud.com」設立。サービス開始は3か月後を予定</a>
<a href='#fnref:2' rev='footnote'>↩</a></p>
</li>
	</ol>
</div>
</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iPhoneでMailboxとDropboxを連携して1GBゲット]]></title>
    <link href="http://rcmdnk.github.io/blog/2013/08/18/computer-ios-dropbox/"/>
    <updated>2013-08-18T15:49:00+02:00</updated>
    <id>http://rcmdnk.github.io/blog/2013/08/18/computer-ios-dropbox</id>
    <content type="html"><![CDATA[<p><a href="https://www.dropbox.com/">Dropbox</a>の新たなキャンペーンとして、
<a href="https://itunes.apple.com/jp/app/mailbox/id576502633?mt=8">Mailbox</a>
と連携することで1GBゲットできるキャンペーンが始まったようなので<sup id='fnref:1'><a href='#fn:1' rel='footnote'>1</a></sup>
Mailboxを入れてゲットしていみました。</p>

<!-- more -->


<p><br class="clearBoth">

<h1>Contents</h1>
{:TOC}

<script type="text/javascript"><!--
google_ad_client = "ca-pub-3802317723662375";
/* imgRectMid */
google_ad_slot = "9043394444";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>




</p>

<h1 id="Dropboxの容量増加ページを見てみると">Dropboxの容量増加ページを見てみると</h1>

<p>Web上のDropboxの自分のホームから上にある<code>無料で容量アップ</code>の項目に行くと、
次の様な項目が追加されています。</p>

<p><img src="/images/post/20130818_dropbox_mailbox.png" "" ""></p>

<p>iPhoneなどiOSでMailboxを連携させると1GB貰えるようです。
(Androidは今のところ話無しの様。)</p>

<h1 id="Mailboxをインストールしてみる">Mailboxをインストールしてみる</h1>

<p>一時期Gmailの新しいメールクライアントとして登録することに行列を作るという
様なことをやっていたMailboxですが、
基本的な思想はInboxにあるメールに手動で簡単にいつ読むか、重要度などを設定出来るのが
強みだと思いますが、
Gmailだけ対応なのと、手動で振り分けする前にラベルで振り分けで充分
(逆に手動でやってられない)ので使ってませんでした。</p>

<p>ということで、無料なので取り敢えずApple StoreからiPhoneにインストール。</p>

<p>Googleアカウントと紐付けようとした所、Gmailとの連携時に
<code>IMAP Folders Disabled    Mailbox needs access to your IMAP folders in order to sync your data. Please enable your AllMail, Snet, Trash and [Mailbox] folders in Gmail settings and try again.</code>と言ったエラーが出て進めない。</p>

<p>Gmailの設定を見てみると<sup id='fnref:2'><a href='#fn:2' rel='footnote'>2</a></sup>、IMAPは有効にしてあったのですが、
<code>すべてのメール</code>(<code>AllMail</code>)で<code>IMAPで表示</code>のチェックが外れてました。
基本、すべてのメールにラベル付けしているので、
普段、PCのメールクライアントで見るときに、すべてのメールも同期すると
余計に未読数が増えて見えたり、すべてローカルに取ってくる設定だと
重複してしまうのでこの設定は外してました。</p>

<p>ので、一時的にここにチェックを入れてiPhoneでMailboxを再び試してみると
上手く行きました。
後は、設定からDropboxとの連携をポチッとするだけ。(Dropboxは当然インストールされてるとして。)</p>

<p>これで、Dropboxのページを見ると、
獲得したボーナス容量のページに<code>Linking with the Mailbox app</code>として1GB追加されてました。</p>

<p>ちなみに、Mailboxで最初連携ができなかった時、<code>[Mailbox]</code>というラベルを
Gmail側に作れば良い、という様なのをいくつか見かけましたが、
現在はこれは作らなくて良いようです。(MailboxとGmailを連携した後このラベルは自動で作られる様。)</p>

<p>試しにちょっとMailboxを使ってみましたが、一度手動でいつ見るか振り分ける、
という作業をGmailだけでそれもiPhone上でやる気にならないのでやはり使わないかな、と。
GmailだけじゃなくてIMAPやExchange等全般的に対応してデスクトップクライアントも
あればその機能そのものは割と使いこなせば便利だとは思うのですが。。。</p>

<hr />

<p><div class="footnotes">
	<ol>
		<li id='fn:1'><p><a href="http://lifehacker.com/mailbox-users-can-get-a-free-gigabyte-of-dropbox-space-1159534393">Get 1GB of Free Dropbox Space with Mailbox for iOS</a>
  <a href='#fnref:1' rev='footnote'>↩</a></p>
</li><li id='fn:2'><p>Gmailページの左のラベル一覧の一番下にある<code>ラベルの管理</code>からチェック。
<a href='#fnref:2' rev='footnote'>↩</a></p>
</li>
	</ol>
</div>
</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Vim 7.4をCygwinへインストール]]></title>
    <link href="http://rcmdnk.github.io/blog/2013/08/17/computer-windows-cygwin-vim/"/>
    <updated>2013-08-17T00:44:00+02:00</updated>
    <id>http://rcmdnk.github.io/blog/2013/08/17/computer-windows-cygwin-vim</id>
    <content type="html"><![CDATA[<p>Vim 7.4の正式版がリリースされたので、
Cygwinへもインストールしました。
現在のCygwinで配布されてるバイナリは7.3+patch 1-1110, 1112-1152
なので、ソースからビルドしてインストールです<sup id='fnref:1'><a href='#fn:1' rel='footnote'>1</a></sup>。</p>

<!-- more -->


<p><br class="clearBoth">

<h1>Contents</h1>
{:TOC}

<script type="text/javascript"><!--
google_ad_client = "ca-pub-3802317723662375";
/* imgRectMid */
google_ad_slot = "9043394444";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>




</p>

<h1 id="Mercurielをインストール">Mercurielをインストール</h1>

<p>Mercurielをまだインストールしてなかったので
<a href="/blog/2013/08/08/computer-windows-cygwin/">apt-cyg</a>で</p>

<pre><code>apt-cyg -u install mercurial
</code></pre>

<p>最初大文字で<code>Mercurial</code>やコマンドの<code>hg</code>で探しても見つからなかったので
ソースからインストールしなきゃいけないのかと思いましたが、
普通に<code>mercurial</code>でありました。。。</p>

<h1 id="Vimをインストール">Vimをインストール</h1>

<p><a href="/blog/2013/08/11/computer-linux-windows-cygwin/">Stow</a>を使って管理するようにします。
オプションはマルチバイト対応とLuaやPythonなどいくつかのインタプリタを有効に。以前までの色々のオプションはざっくり落としてみました。(要らないものをdisableしてもあまり意味が無い感じがしてきたので。)</p>

<pre><code>$ cd ~/tmp/
$ hg clone https://vim.googlecode.com/hg/ vim
$ ./configure  --prefix=$HOME/usr/local/stow/vim-7.4  --enable-multibyte  --enable-luainterp=yes  --enable-perlinterp=no --enable-pythoninterp=yes --enable-python3interp=yes --enable-tclinterp --enable-rubyinterp=yes
$ make &amp;&amp; make install
$ cd ~/usr/local/stow
$ stow vim-7.4
</code></pre>

<p>こんな感じで<code>~/usr/local/</code>へ。</p>

<hr />

<p><div class="footnotes">
	<ol>
		<li id='fn:1'><p>MacではHomebrew版のHEADが7.4になってますのでHomebrewで入れればOK。
  (<a href="/blog/2013/08/07/computer-vim">Lua対応Vimをインストール</a>)
<a href='#fnref:1' rev='footnote'>↩</a></p>
</li>
	</ol>
</div>
</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[stowでmake installしたパッケージを管理]]></title>
    <link href="http://rcmdnk.github.io/blog/2013/08/11/computer-linux-windows-cygwin/"/>
    <updated>2013-08-11T03:53:00+02:00</updated>
    <id>http://rcmdnk.github.io/blog/2013/08/11/computer-linux-windows-cygwin</id>
    <content type="html"><![CDATA[<p><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B003KOAR0G/rcmdnk0c-22/ref=nosim/" rel="nofollow" target="_blank" ><img class="left" src="http://ecx.images-amazon.com/images/I/41PYjDYaZvL._SL160_.jpg" border="0"></a></p>

<p><a href="/blog/2013/08/04/computer-linux-mac/">pacoでmake installしたパッケージを管理</a>
で書いた様に、Linux(WindowsのcoLinuxも含む)で
make installしたパッケージも管理出来る様にしましたが、
Cygwinにもpacoを入れようとした所コンパイル出来なかったので
代わりにstowと言うインストーラーを入れました。</p>

<!-- more -->


<p><br class="clearBoth">

<h1>Contents</h1>
{:TOC}

<script type="text/javascript"><!--
google_ad_client = "ca-pub-3802317723662375";
/* imgRectMid */
google_ad_slot = "9043394444";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>




</p>

<h1 id="Cygwinではpacoをコンパイル出来ない">Cygwinではpacoをコンパイル出来ない</h1>

<p>pacoのパッケージを取ってきてCygwinでコンパイルしようとすると</p>

<pre><code>log.c:67:20: error: ‘RTLD_NEXT’ undeclared (first use in this function)
</code></pre>

<p>と言った様なエラーが出てコンパイル出来ないのですが、これはglibcが入ってないからですが、
Cygwinではglibcは入れられない様です<sup id='fnref:1'><a href='#fn:1' rel='footnote'>1</a></sup>。</p>

<p>いくつかそれっぽいものはありましたが<sup id='fnref:2'><a href='#fn:2' rel='footnote'>2</a></sup><sup id='fnref:3'><a href='#fn:3' rel='footnote'>3</a></sup>、素直に入れることは
出来なそうなのでpacoは辞めておくことに。</p>

<h1 id="stow">stow</h1>

<p><a href="http://www.gnu.org/software/stow/">stow</a>はpacoと同じ様な<code>make install</code>などで
<code>apt-get</code>などを通さず直接インストールするパッケージを管理する
インストーラーです。</p>

<h2 id="paco+v.s.+stow">paco v.s. stow</h2>

<p>pacoとstowの違いは</p>

<ul>
<li>paco: <code>/usr/local/var/log/paco</code>等のディレクトリ以下にパッケージ名情報ファイルを作り、
その情報を元にインストールされたファイルを管理する。</li>
<li>stow: <code>/usr/local/stow/</code>等のディレクトリ以下にパッケージ名ディレクトリを作り、
その中にパッケージをインストールする。
そこから<code>/usr/local/</code>などへリンクを張る。</li>
</ul>


<p>pacoでインストールした場合は、パッケージ自体は通常通りインストールされるので、<code>/usr/local/var/log/paco</code>自体を削除しても問題有りません。</p>

<p>stowの場合は<code>/usr/local/</code>へはリンクが貼られるだけなので
通常インストールとは形が変わります。
一方、stowは<code>/usr/local/stow/</code>からのリンクを管理するので、
例えば1つのパッケージでバージョンの違う物を両方インストールしておいて、
一時的に切り替える事が簡単に出来ます。
新しいバージョンを入れて取り敢えず試してみる、と言うことができるので、
その点でstowが結構便利かもしれません。</p>

<h2 id="stowインストール">stowインストール</h2>

<ul>
<li>Cygwin</li>
</ul>


<p><a href="/blog/2013/06/24/computer-windows-git-cygwin/">apt-cyg</a>で</p>

<pre><code>$ apt-cyg install stow
</code></pre>

<ul>
<li>Mac</li>
</ul>


<p><a href="/blog/2013/06/21/computer-mac/">Homebrew</a>で</p>

<pre><code>$ brew install stow
</code></pre>

<ul>
<li>Linux</li>
</ul>


<p>apt-getなど。root権限がないところでローカルに入れる場合は自分もstowで管理。</p>

<pre><code>$ cd ~/tmp/
$ wget http://ftp.gnu.org/gnu/stow/stow-2.2.0.tar.gz
$ tar xzf stow-2.2.0.tar.gz
$ cd stow-2.2.0
$ ./configure --prefix=$HOME/usr/local/stow/stow-2.2.0
$ make &amp;&amp; make install
$ cd ~/usr/local/stow
$ ./stow-2.2.0/bin/stow stow-2.2.0
</code></pre>

<h2 id="stowの使い方">stowの使い方</h2>

<p>まず、stowで管理するパッケージをインストールするディレクトリを決めておきます。
通常は最終的にインストールするディレクトリ下にstowというディレクトリを作ります。
(上の場合は<code>$HOME/usr/local/</code>に<code>bin/stow</code>などをインストールするので
<code>$HOME/usr/local/stow</code>ディレクトリを作って入れています。)</p>

<p>パッケージをインストールする際は、prefix等でインストール先を
<code>$HOME/usr/local/stow</code>+<code>パッケージ名</code>に指定して後は通常通りインストールします。</p>

<p>インストール後、stowディレクトリへ行き、</p>

<pre><code>$ stow package
</code></pre>

<p>とすることで、package内から<code>../</code>の<code>/bin/</code>等へリンクが張られます。</p>

<p>アンインストールは</p>

<pre><code>$ stow -D package
</code></pre>

<p>とするとリンクが削除されます。パッケージがその後必要なければ
stowディレクトリから実体も削除すればOK。</p>

<p>バージョンの違う同じパッケージをインストールしてる場合は</p>

<pre><code>$ stow -D package-1.0
$ stow package-2.0
</code></pre>

<p>の様にすれば1.0から2.0へ切り替える事が出来、
実体は残ったままなので、同じ様に1.0に戻る事もすぐ出来ます。</p>

<pre><code>$ stow -n package-2.0
</code></pre>

<p>とすると、ドライランすることが出来ます。</p>

<p>通常は、カレントディレクトリがstowディレクトリ、親ディレクトリが
リンクを作るインストール先ですが、これを変えたい場合は</p>

<ul>
<li><code>-d stow_dir</code>、<code>--dir=stow_dir</code>でstowディレクトリを指定。</li>
<li><code>-t target_dir</code>、<code>--target=target_dir</code>でインストール先ディレクトリを指定。</li>
</ul>


<p>します。ただ、pacoの場合と違い、これらの情報は残らないので、
特別指定した場合はアンインストールする場合も指定する必要があるので、
管理上、最終的なインストール先の下にstowディレクトリを作るのが良いかと思います。</p>

<h2 id="すでにインストールしてあるパッケージに対してstowで再インストールする場合">すでにインストールしてあるパッケージに対してstowで再インストールする場合</h2>

<p>すでにパッケージがインストールしてあると、
リンクでなく実体が存在するのでstowでリンクを作ろうとすると
エラーが出ます。
(<code>-D</code>で削除しようとするとリンクじゃない、と言って削除してくれない。)
一旦それらのファイルを削除しないとstowで管理しようがないみたいで、
結構面倒です。</p>

<p>そこで<a href="https://github.com/rcmdnk/scripts/blob/master/stowReset.sh">stowReset.sh</a>
と言うスクリプトを作りました。</p>

<p>使い方は、まず、インストールしたいパッケージをstowディレクトリに
インストールした後、
stowディレクトリに行き、</p>

<pre><code>$ stowReset.sh package
</code></pre>

<p>とすると、packageに関連するファイルが親ディレクトリから削除されます。
stow同様に<code>-d</code>、<code>-t</code>、<code>-n</code>のオプションが使えます(<code>--dir</code>等2重ハイフンオプションは未対応)。</p>

<p>その後、通常通り、</p>

<pre><code>$ stow package
</code></pre>

<p>とすればリンクを作れる様になります。</p>

<h1 id="まとめ">まとめ</h1>

<p>pacoに比べて、新しいバージョンのテスト等にも便利に使えそうなので、
MacやLinuxでもpacoからstowへ移行しようと思います。</p>

<p>pacoだとconfigureの引数等の情報がそのまま残るのでちょっと便利ですが、
その点はちゃんとメモするようにしておけばOKかな、と。</p>

<hr />

<p>追記 2013/08/28</p>

<p><strike>暫く使ってみて問題発見。stowだと、<code>~/usr/local/stow</code>の下にパッケージディレクトリを置いて、
そこから<code>~/usr/local/</code>へリンクを張るわけですが、その際、例えば
<code>~/usr/local/bin</code>がある場合はその下からリンクを作り始め、一方<code>bin</code>ディレクトリが
ない場合は<code>bin</code>自体がリンクになってしまうみたいです。</p>

<p>つまり、最初に何も<code>~/usr/local/</code>にない状態で<code>vim</code>などをインストールすると、
<code>~/usr/local/bin</code>が<code>~/usr/local/stow/vim/bin</code>などへのシンボリックリンクになってしまいます。
こうなると、次に別のソフトをインストールするときに実質的に<code>~/usr/local/stow/vim/bin</code>内に
シンボリックリンクを置くことになってしまうので<code>~/usr/local/stow/vim/</code>を削除してしまうと
<code>~/usr/local/bin</code>自体がリンク切れになってしまいますし、vimをアップデートすると他のソフトのインストールが消えます。</p>

<p>stowのインストールでディレクトリはリンクでなく必ず掘る様にして、
また、アンインストール時はディレクトリ内に何も無いときに限り消す、みたいなラッパーを作れば良いのだと思うのですが。。。
(sourceコード直接いじった方が楽かな。。。？)そのうちなんとかしたい所。
できればpacoみたいにconfigureオプションを保存出来る様になればなおもよしですが。。。
</strike></p>

<hr />

<hr />

<p>さらに追記 2013/08/29</p>

<p>stowは意外と賢かったです。マニュアルを見たらこの辺をきちんと処理する様になってることが
分かりました。</p>

<p>最初にインストールする時は最も上位のディレクトリだけのリンクを作ろうとして
これを<code>folding</code>と呼んでいます。</p>

<p>で、<code>~/usr/local/bin</code>等が<code>~/usr/local/stow/vim/bin</code>などへのシンボリックリンクの
状態で、次にgit等をインストールすると、<code>bin</code>がシンボリックだと言う事を理解して、
まず、vimへのリンクを消し、新たにディレクトリを作り、
その中にvimとgitの<code>bin</code>内のコンテンツへのリンクを作りなおしてくれます。</p>

<p>逆に、<code>stow -D</code>で削除していく時も、中身が1つのパッケージだけになったディレクトリは
まとめてシンボリックリンクに変えられます。</p>

<p>自分でディレクトリを作ってしまったりするとこのアンインストール時に
無駄にディレクトリを残してしまうことが有ります。
(2つ以上のパッケージが同じディレクトリを使っていると、アンインストールしていって
最後の1つになった時にそのディレクトリをシンボリックリンクにしてくれますが、
最初から1つしか無いとそのディレクトリはパッケージをアンインストールしても残ってしまいます。)</p>

<p>なので、基本的に<code>bin</code>等を自分で作るべきではないです。</p>

<p>これに関連するオプションで<code>--no-folding</code>というオプションが有ります(<code>stow -h</code>では記述を忘れてるのか出て来ない)。
このオプションをインストール時につけると、所謂上で間違って指摘していたような、
各ディレクトリをシンボリックリンクでなく全て掘り下げる様に作ってくれます。
ただ、これをしてしまうとアンインストール時にからディレクトリのゴミが残ります。</p>

<p>また、<code>--no-folding</code>をアンインストール時に使うと、仮にそのディレクトリ内が
1つのパッケージだけになるような場合でもシンボリックリンクに変えたりしないで
そのまま残します。
この場合も後々アンインストールするときにゴミが残るような状態になります。</p>

<p>ので、特別理由がない限りあまり使うことはなさそうです。</p>

<p>他に、<code>--adopt</code>というオプションもあり、ちょっと特殊な動きをします。
通常、stowでインストールするとき、上に書いたように、先にシンボリックリンクでない
普通のファイルがインストールされていると上書きできずにエラーとなります。
しかし、このオプションを使うと、もし、通常ファイルがある場合、
<code>そのファイルをstowディレクトリにあるパッケージにコピーした上でシンボリックリンクを作る</code>、という動きをします。</p>

<p>ここで注意しなければいけないのは、もともとパッケージに入っているファイルが上書きされることです。
つまり、古いファイルが残っていて、それを上書きできる様なオプションではありません。</p>

<p>このオプションの使い道としては、上で作っった<code>stowReset.sh</code>を使わなくてはいけない様な状況で、
パッケージをstowディレクトリにインストール後、一度そのコピーを作り、
そのコピーパッケージでadoptし、その後、オリジナルのパッケージをrestowする、とかでしょうか？</p>

<pre><code>$ pwd
~/usr/local/stow
$ ls
vim
$ cp -r vim vim.tmp
$ stow --adopt vim.tmp &amp;&amp; stow -D vim.tmp &amp;&amp; rm -rf stow.tmp
$ stow vim
</code></pre>

<p>これで、<code>stowReset.sh</code>でやってることと同じことが出来ます。</p>

<hr />

<p><div class="footnotes">
	<ol>
		<li id='fn:1'><p><a href="http://cygwin.com/faq.html#faq.programming.glibc">Where is glibc?</a>
  <a href='#fnref:1' rev='footnote'>↩</a></p>
</li><li id='fn:2'><p><a href="http://www.gurucoding.com/en/pc_cross_compiler/building_glibc_cygwin_vm.php">Building GLibc in the Cygwin VM</a>
  <a href='#fnref:2' rev='footnote'>↩</a></p>
</li><li id='fn:3'><p><a href="http://artfiles.org/cygwin.org/pub/glibc/releases/">Index of /cygwin.org/pub/glibc/releases</a>
<a href='#fnref:3' rev='footnote'>↩</a></p>
</li>
	</ol>
</div>
</p>
]]></content>
  </entry>
  
</feed>
