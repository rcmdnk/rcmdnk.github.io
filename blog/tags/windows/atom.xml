<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: Windows | rcmdnk's blog]]></title>
  <link href="https://rcmdnk.com/blog/tags/windows/atom.xml" rel="self"/>
  <link href="https://rcmdnk.com/"/>
  <updated>2018-08-23T00:51:36+00:00</updated>
  <id>https://rcmdnk.com/</id>
  <author>
    <name><![CDATA[rcmdnk]]></name>
    <email><![CDATA[rcmdnk@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Evernoteで*を自動でリストに変換したりする機能を止める]]></title>
    <link href="https://rcmdnk.com/blog/2018/05/17/computer-mac-windows-evernote/"/>
    <updated>2018-05-17T00:00:00+00:00</updated>
    <id>https://rcmdnk.com/blog/2018/05/17/computer-mac-windows-evernote</id>
    <content type="html"><![CDATA[<p>Evernoteでメモを書いているとき、
Markdown形式でメモを書くことが多いのですがその際リスト表示で<code>*</code>とかを先頭に使うと
Evernoteがリッチなリスト表示に勝手に変換してくれます。</p>

<p>Evernoteだけで閉じるならまだしも他にもコピーしたりすることもあるのと、
ちょっと表示もあまりよろしくないのでこれを止める様にしました。</p>

<!-- more -->

<ul id="markdown-toc">
  <li><a href="#設定変更" id="markdown-toc-設定変更">設定変更</a></li>
  <li><a href="#アプリの設定以外にosやimeの設定もあるので注意" id="markdown-toc-アプリの設定以外にosやimeの設定もあるので注意">アプリの設定以外にOSやIMEの設定もあるので注意</a></li>
</ul>
<div class="group"></div>

<div class="center_wrapper">
  <div>Sponsored Links</div>
  <div>
  <ins class="adsbygoogle google-img-rect" style="display:inline-block" data-ad-client="ca-pub-3802317723662375" data-ad-slot="7116417646"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  </div>
</div>

<h2 id="設定変更">設定変更</h2>

<p>Macの場合、メニューバーの<strong>Evenote</strong>から<strong>環境設定</strong><i class="fa fa-arrow-right"></i><strong>書式設定</strong>に行き
<strong>リスト、水平線、絵文字をキーボードショートカットで自動作成する。</strong>のチェックを外す。</p>

<p><img src="https://rcmdnk.com/images/post/20180517_evernotemac.jpg" alt="20180517_evernotemac.jpg" class="pic" /></p>

<p>Windowsの場合、<strong>ツール</strong><i class="fa fa-arrow-right"></i><strong>オプション</strong>を開き
<strong>ノート</strong>の項目に行き<strong>テキストの書式を自動設定</strong>の項目のチェックを外す。</p>

<p><img src="https://rcmdnk.com/images/post/20180517_evernotewin.jpg" alt="20180517_evernotewin.jpg" class="pic" /></p>

<p>上の写真だと<strong>テキストの書式を自動設定</strong>以下に<strong>“1, “で番号付きリスト</strong>云々という設定がいくつかありますが、
これらの設定は<strong>テキストの書式を自動設定</strong>のチェックを外すと全て無効になります。</p>

<h2 id="アプリの設定以外にosやimeの設定もあるので注意">アプリの設定以外にOSやIMEの設定もあるので注意</h2>

<p>Evernoteで編集してる際に、上記に加えてハイフンを2つ書くと大きな一つのハイフンになってしまうことがあり、
その項目が見つからないな、と思っていたのですが
それはMacの設定によるものでした。</p>

<p><a href="http://octopress.test/blog/2018/05/16/computer-mac/">http://octopress.test/blog/2018/05/16/computer-mac/</a></p>

<p>英文先頭文字を大文字に変換するとかの項目もデフォルトでオンになっています。
これらの項目はGoogle日本語入力とかを使っていても有効です。</p>

<p>それ以外にもIMEの設定とかで意図せぬ動作を設定している場合もあるので、
何か動作がおかしいな、と思った際には、OSの設定、IMEの設定、アプリの設定と
全てチェックする必要があります。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Windowsで公式ツールでSSHサーバーを立てる2つの方法]]></title>
    <link href="https://rcmdnk.com/blog/2018/04/27/computer-windows-network/"/>
    <updated>2018-04-27T00:00:00+00:00</updated>
    <id>https://rcmdnk.com/blog/2018/04/27/computer-windows-network</id>
    <content type="html"><![CDATA[<p>以前はWindowsをSSHサーバーにしようと思うとCygwinを入れたりとか
サードパーティー的なもので無理やり構築する必要がありましたが、
最近のアップデートでオフィシャルな感じで簡単にSSHサーバーにすることができるようになりました。</p>

<!-- more -->

<ul id="markdown-toc">
  <li><a href="#前にやってたこととか" id="markdown-toc-前にやってたこととか">前にやってたこととか</a></li>
  <li><a href="#openssh-server" id="markdown-toc-openssh-server">OpenSSH Server</a></li>
  <li><a href="#windows-subsystem-for-linux-wsl" id="markdown-toc-windows-subsystem-for-linux-wsl">Windows Subsystem for Linux (WSL)</a></li>
  <li><a href="#ポート開放" id="markdown-toc-ポート開放">ポート開放</a></li>
  <li><a href="#使えるか" id="markdown-toc-使えるか">使えるか?</a></li>
</ul>
<div class="group"></div>

<div class="center_wrapper">
  <div>Sponsored Links</div>
  <div>
  <ins class="adsbygoogle google-img-rect" style="display:inline-block" data-ad-client="ca-pub-3802317723662375" data-ad-slot="7116417646"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  </div>
</div>

<h2 id="前にやってたこととか">前にやってたこととか</h2>

<p>以前、WindowsでCygwinを入れてSSHサーバーを立てたりしていました。</p>

<blockquote>
  <p><a href="http://osksn2.hep.sci.osaka-u.ac.jp/~naga/miscellaneous/winssh/winssha.html">ウィンドウズにSSHサーバーを入れよう！</a></p>
</blockquote>

<p>他にも色々とSSHサーバーを立てる</p>

<p>最近だとちょっと用途は違うかもしれませんが、Virtual Machine上にLinuxを入れて、とかで
サーバーを立ててる人もいると思います。</p>

<p>また、数年前から公式なSSHツールの開発も進められていて
自分でインストールすることで使うこともできるようになっていました。</p>

<blockquote>
  <p><a href="https://github.com/PowerShell/Win32-OpenSSH">PowerShell/Win32-OpenSSH: Win32 port of OpenSSH</a></p>
</blockquote>

<blockquote>
  <p><a href="https://github.com/PowerShell/openssh-portable">PowerShell/openssh-portable: Portable OpenSSH, all Win32-OpenSSH releases and wiki are managed at https://github.com/powershell/Win32-OpenSSH</a></p>
</blockquote>

<p>このツールが今はWindowsから簡単な操作で有効にできる様になっています。</p>

<h2 id="openssh-server">OpenSSH Server</h2>

<p>昨年のAnniversary UpdateでWindows本体に導入され、まずは開発者モードでのみ使える様になっていたOpenSSH Server(及びClient)。
さらに昨年末から今年始めにかけて配布されていたFall Creators Updateでこれらがオプション機能として開発者モードでなくても簡単に
追加できる様になりました。</p>

<p>このAnniversary Updateが入った時に、開発者モードにしていると自動でSSHサーバーが立ち上がる様になっていたとかで
ちょっと騒ぎになった様なこともあった気がしますが、
現在のWindowsではSSHの機能はデフォルトではOFFになっています。</p>

<p>有効にするには<strong>Windowsの設定</strong>から<strong>アプリ</strong>へ行き、<strong>アプリと機能</strong>のページにある<strong>アプリと機能</strong>の欄の<strong>オプション機能の管理</strong>を開きます。
ここで<strong>機能追加</strong>へ行くと
<strong>OpenSSH Server (Beta)</strong>というのがあるのでこれをインストールします。
とりあえずのテストとかでも便利なのでついでに必要なら<strong>OpenSSH Client (Beta)</strong>も。</p>

<p>ここで2つ一気にインストールしようとすると失敗することもあるので
ちゃんと<strong>オプション機能の管理</strong>ページにインストールしたものが追加されてるか確認してください。</p>

<p>出来たらPowerShellなりコマンドプロンプトを立ち上げて</p>

<pre><code>&gt; ssh localhost
</code></pre>

<p>とやってssh接続できるか試してみます。</p>

<p>Puttyとかで<code>localhost</code>に向けて<code>ssh</code>してもチェックできます。</p>

<p>上手く行かない場合、サービスが動いているかチェックするため、
コルタナから<strong>サービス</strong>とかで検索してサービスのウィンドウを立ち上げ、<code>sshd</code>という名前のサービスが<strong>実行中</strong>になっているかチェックします。</p>

<p>もし<code>sshd</code>がなければ上のインストールの所で失敗してるのでもう一回チェック。
<strong>実行中</strong>になってなければ開始します。
今後も使いたいのであればスタートアップが<strong>自動</strong>になっているかなどもチェック。</p>

<p>うまくssh出来た場合、
ログインした先のデフォルトシェルはコマンドプロンプトになっていますが、
PowerShellを使いたい場合は</p>

<pre><code>&gt; powershell.exe
</code></pre>

<p>と実行するとPowerShellに切り替わります。</p>

<p>レジストリを書き換えるとPowerShellやWSL-bash.exeなどに変更できる、との
記述もありましたが下記にあるやり方だと変更が有効になりませんでした。</p>

<blockquote>
  <p><a href="https://github.com/PowerShell/Win32-OpenSSH/wiki/Install-Win32-OpenSSH">Install Win32 OpenSSH · PowerShell/Win32-OpenSSH Wiki</a></p>
</blockquote>

<p>PowerShellを管理者権限で開いて</p>

<pre><code>&gt; New-ItemProperty -Path "HKLM:\SOFTWARE\OpenSSH" -Name DefaultShell -Value "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -PropertyType String -Force
</code></pre>

<p>とするとレジストリを書き換えて上のページの例にあるような設定に出来たのですが、</p>

<pre><code>&gt; net stop sshd
&gt; net start sshd
</code></pre>

<p>としてSSHサーバーを再起動したりWindows自体を再起動してもSSHするとコマンドプロンプトのままでした。</p>

<p>そのうちまた要チェック。</p>

<p>また、次のWindows Subsytem for Linuxを使う場合には必ずこちらのsshサービスを止めてから
行ってください。
そうでないとこちらのサービスのほうが優先されてLinux側のSSHサーバーが見えなくなります。</p>

<p>もしくはどちらかのサービスのポートを変える必要があります。</p>

<h2 id="windows-subsystem-for-linux-wsl">Windows Subsystem for Linux (WSL)</h2>

<p>もう一つの方法はWindows Subsystem for Linux (WSL)でLinuxを動かしてその中でsshサーバーを動かす方法。
WLSは数年前から開発者向けに使えるようになっていましたが、
Fall Creators Updateで正式に導入され、今は簡単に導入することが出来ます。</p>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail">
  <a href="https://rcmdnk.com/blog/2016/06/05/computer-windows-ubuntu-bash/"><img class="small-thumbnail-img" src="https://rcmdnk.com/images/post/thumbnail/20160605_bashonubuntuonwindows_120_90.jpg" width="120" height="90" alt="20160605_bashonubuntuonwindows_120_90" /></a>
</div><a class="click_box_link" href="https://rcmdnk.com/blog/2016/06/05/computer-windows-ubuntu-bash/">Windowsに採用されたBash (Ubuntu)を試してみる</a></div></li></ul>

<p>導入するには<strong>Windowsの機能の有効化または無効化</strong>を開き
<strong>Windows Subsytem for Linux</strong>にチェックを入れます。</p>

<p>再起動して有効化した後、Microsoft Storeを開いて<strong>Ubuntu</strong>などを探してインストールします。</p>

<p>今はUbuntu以外にもDebianやopenSUSEとかいくつかありますがとりあえず今回はUbuntuで。</p>

<p>インストールするとスタートメニューに<strong>Ubuntu</strong>があるはずなのでそれを立ち上げます。
最初に</p>

<pre><code>Installing, this may take a few minutes...
</code></pre>

<p>みたいな表示がでてしばらく待ちますが、これ、上手く言ってもこのまま進まないことがあるので、
しばらく立ったら適当にキーを押して進行状況を確認してみてください。</p>

<p>また、最初にインストールするとき、</p>

<pre><code>It appears this distro's installation has become corrupted.
Please try uninstalling and reinstalling the app.
Installation Failed!
Error: 0x800700b7
Press any key to continue...
</code></pre>

<p>みたいなエラーが出ることがあります。(Errorコードが0x8000000dだったりもする。)</p>

<p>この場合、よくわからないのですが、とりあえず一度<strong>Ubuntu</strong>をアンインストールして
もう一度インストールすると上手く行くことがあります。</p>

<p>上手く行った場合はユーザー名やパスワードを聞かれますが、これは
Windowsのものとは別でも好きなものに設定できます。</p>

<p>Ubuntuが出来たらSSHサーバーを立ち上げますが、ストアからインストールしたUbuntuには
最初から入っているので、</p>

<pre><code>$ sudo service ssh start
</code></pre>

<p>とすればサーバーをスタートできます。</p>

<p>が、最初にやったとき、</p>

<pre><code>$ sudo service ssh start
[sudo] password for user:
* Starting OpenBSD Secure Shell server sshd
Could not load host key: /etc/ssh/ssh_host_rsa_key
Could not load host key: /etc/ssh/ssh_host_dsa_key
Could not load host key: /etc/ssh/ssh_host_ecdsa_key
Could not load host key: /etc/ssh/ssh_host_ed25519_key
                                                                                                                 [ OK ]
$ ssh localhost
Connection closed by 127.0.0.1 port 22
</code></pre>

<p>みたいな感じで上手くいきませんでした。<code>OK</code>と出ていますがちゃんと起動できていませんし
実際に上に出てるファイルもありません。
ファイルの読み込み自体はクリティカルなところではないはずですが、色々と準備が足りない感じです。</p>

<p>そこで、一旦最初に入っているものをアンインストールして再インストールすると上手くいきました。</p>

<pre><code>$ sudo apt-get remove --purge openssh-server
$ sudo apt-get update --fix-missing
$ sudo apt-get install openssh-server
</code></pre>

<p>とします。途中、一回<code>update</code>を行っていますが、これを行わずにすぐに<code>install</code>しようとすると</p>

<pre><code>$ sudo apt-get install openssh-server
[sudo] password for user:
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following package was automatically installed and is no longer required:
  libfreetype6
Use 'sudo apt autoremove' to remove it.
Suggested packages:
  ssh-askpass rssh molly-guard monkeysphere
The following NEW packages will be installed:
  openssh-server
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 338 kB of archives.
After this operation, 912 kB of additional disk space will be used.
Err:1 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 openssh-server amd64 1:7.2p2-4ubuntu2.2
  404  Not Found [IP: 2001:67c:1560:8001::14 80]
E: Failed to fetch http://archive.ubuntu.com/ubuntu/pool/main/o/openssh/openssh-server_7.2p2-4ubuntu2.2_amd64.deb  404  Not Found [IP: 2001:67c:1560:8001::14 80]
</code></pre>

<p>みたいなエラーが出たので<code>update</code>をしてから行ったところうまくいきました。</p>

<p>このインストールでssh鍵とかも出来て</p>

<pre><code>$ sudo service ssh start
</code></pre>

<p>とすると無事立ち上がりsshで入れる様になりました。</p>

<p>ただし、注意として上にも書いたようにWindowsのOpenSSHサーバーが動いていると
そちらが優先されるのでsshしたらコマンドプロンプトが立ち上がった、という場合には
そちらを切るなどする必要があります。</p>

<p>また、このサーバーはUbuntuを立ち上げてる時だけ動いているので、
Ubuntuのターミナルを閉じると落ちてしまいます。</p>

<p>Ubuntu自体はバックグラウンドでも走れる様になったみたいで、
Windowsのスタートアップ時にsshサーバーを走らせるUbuntuを実行する
みたいなことをするとsshサーバーを裏で動かすこともできる様ですが
どうも上手く行かなかったのでまたそのうち試してみます。</p>

<h2 id="ポート開放">ポート開放</h2>

<p>これでローカルではSSHできるようになりましたが、外から入ろうとすると弾かれます。</p>

<p><strong>コントロールパネル</strong><i class="fa fa-arrow-right"></i>
<strong>システムとセキュリティ</strong><i class="fa fa-arrow-right"></i>
<strong>Windows Defenderファイヤウォール</strong><i class="fa fa-arrow-right"></i>
<strong>詳細設定</strong>
に行き<strong>受信の規則</strong>を選択して<strong>新しい規則</strong>を作ります。</p>

<ul>
  <li>規則の種類: ポート</li>
  <li>プロトコルおよびポート: TCP, 特定のローカルポート: 22</li>
  <li>操作: 接続を許可する</li>
  <li>プロファイル: そのまま(でファルトは全部チェック。必要があれば入られたくないところのチェックを外す。</li>
  <li>名前: ssh (適当に)</li>
</ul>

<p>みたいな感じで新しい規則を作ります。</p>

<p>これでSSHの22番ポートが開放されるので他のPCからも入れる様になるはずです。</p>

<h2 id="使えるか">使えるか?</h2>

<p>ということでWindowsの公式機能としてSSHサーバーを立てることができる様になりました。</p>

<p>コマンドプロンプト(or PowerShell)使いたい場合hには最初の方法、
Linuxを使いたい場合にはUbuntuなどをWLSで使う方法があります。</p>

<p>これで実際にどうこうできるか、という話ですが、
コマンドプロンプトとかを使い慣れていればその作業は十分にできると思います。</p>

<p>Linuxに関してはLinuxとしてはWLS下での制限が色々ありますがとりあえず簡単にSSHできる環境としては作れます。
ただ、サービスのように立ち上げるのがちょっと面倒。</p>

<p>さらには未だにGNU screenとかがユーザー権限で立ち上がらなかったりしますが。</p>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail">
  <a href="https://rcmdnk.com/blog/2016/09/01/computer-windows-ubuntu-bash/"><img class="small-thumbnail-img" src="https://rcmdnk.com/images/post/thumbnail/20160605_bashonubuntuonwindows_120_90.jpg" width="120" height="90" alt="20160605_bashonubuntuonwindows_120_90" /></a>
</div><a class="click_box_link" href="https://rcmdnk.com/blog/2016/09/01/computer-windows-ubuntu-bash/">Bash on Ubuntu on WindowsでGNU screenが使える様になった</a></div></li></ul>

<p>また、Linux側からWindowsに対して色々自由にできるわけでもないので外からここに入って何ができるか、というのは微妙なところです。</p>

<p>一方、今回は中心の話題ではなかったですが、
<strong>OpenSSH Client (Beta)</strong>
の方が通常使用ではインパクトが大きいかもしれません。</p>

<p>これを入れればWindowsでもサードパーティーなアプリを入れなくても他のマシンに対してSSHできる様になります。</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Windowsで余計な入力言語を削除する方法]]></title>
    <link href="https://rcmdnk.com/blog/2017/11/24/computer-windows/"/>
    <updated>2017-11-24T00:00:00+00:00</updated>
    <id>https://rcmdnk.com/blog/2017/11/24/computer-windows</id>
    <content type="html"><![CDATA[<p>Windowsで作業中に日本語入力を開始しようとしても半角英数のままで変わらないで
どうしたのか、と思ったら入力言語が変わっていました。</p>

<p>余計なものに何かの拍子で切り替わったりアプリごとに勝手に切り替わったりすることで
日本語が使える入力言語ではなくなっていた様です。</p>

<p>とうことでこれらの入力言語を削除します。</p>

<!-- more -->

<ul id="markdown-toc">
  <li><a href="#入力言語リスト" id="markdown-toc-入力言語リスト">入力言語リスト</a></li>
  <li><a href="#以前の削除法" id="markdown-toc-以前の削除法">以前の削除法</a></li>
  <li><a href="#今回うまく行った方法" id="markdown-toc-今回うまく行った方法">今回うまく行った方法</a></li>
  <li><a href="#入力言語を切り替えないようにする" id="markdown-toc-入力言語を切り替えないようにする">入力言語を切り替えないようにする</a></li>
  <li><a href="#まとめ" id="markdown-toc-まとめ">まとめ</a></li>
</ul>
<div class="group"></div>

<div class="center_wrapper">
  <div>Sponsored Links</div>
  <div>
  <ins class="adsbygoogle google-img-rect" style="display:inline-block" data-ad-client="ca-pub-3802317723662375" data-ad-slot="7116417646"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  </div>
</div>

<h2 id="入力言語リスト">入力言語リスト</h2>

<p>普段はGoogle日本語入力を使ってますが、
言語バーの所を見てみると<code>ENG INTL</code>となっています。</p>

<p>それをクリックしてみると</p>

<p><img src="https://rcmdnk.com/images/post/20171124_keyboards.png" alt="keyboards" class="pic" /></p>

<p>こんな感じでGoogle日本語入力に加えて英語の入力言語が2つ加わっています。</p>

<p>最近まで問題なかったのでこれらはなかったはずですが、
恐らく最近アップデートで入れた
<strong>Fall Creators Update</strong>の導入の際に入ったものだと思います。</p>

<p>確かWindows 10を使い始めた時もこの英語の入力言語があって邪魔くさくてなんとかしたな、
と思いながら削除の作業に入ったのですが結構面倒でした。</p>

<h2 id="以前の削除法">以前の削除法</h2>

<p>きちんと覚えてるわけではないのですが、
以前はコントロールパネルを立ち上げて
その中の<strong>時計、言語、および地域</strong><i class="fa fa-arrow-right"></i><strong>言語</strong>に行くと
そこに日本語以外にも英語がありそれを削除すると
余計なリストが消えた、といった感じだったと思います。</p>

<p><img src="https://rcmdnk.com/images/post/20171124_controlpanel.png" alt="controlpanel" class="pic" /></p>

<p>ただ、今回行ってみた所ここには日本語だけになっていてどうしようもありませんでした。</p>

<p>最近のアップデートでWindowsはこのコントロールパネルをかなり隠す様になってきていて、
通常の設定画面からも以前はコントロールパネルへのリンクがあったりしましたが
今は全く(見つけてないだけかもしれませんが)ありません。</p>

<p>設定の影響も以前とは違ったものになってる可能性があります。</p>

<h2 id="今回うまく行った方法">今回うまく行った方法</h2>

<p><strong>Windowsの設定</strong>から<strong>時刻と言語</strong>に行き、
さらに<strong>地域と言語</strong>に行くと言語の設定があります。</p>

<p>ここを見てももともと<strong>日本語</strong>だけがありました。</p>

<p><img src="https://rcmdnk.com/images/post/20171124_language0.png" alt="language0" class="pic" /></p>

<p>ここから言語の<strong>オプション</strong>に行くと
入力言語を追加したり出来ますが、
ここではGoogle日本語入力だけがあります。</p>

<p><img src="https://rcmdnk.com/images/post/20171124_optionjp.png" alt="optionjp" class="pic" /></p>

<p>ここで追加できるのはMicrosoft IME。
これは元々リストにないので入れてみたりしても追加されるだけで何も変わらず。
Microsoft IMEだけ残してみてもやはり英語の入力言語は残った状態でした。</p>

<p>そこで
色々いじってるうちに一度<strong>English (United States)</strong>を追加してみました。</p>

<p><img src="https://rcmdnk.com/images/post/20171124_language.png" alt="language" class="pic" /></p>

<p>このオプション設定に行くと、
最初に見た<strong>USキーボード</strong>がすでにリストされていました。</p>

<p>ここで一度<strong>English (United States)</strong>を削除してみると
<strong>USキーボード</strong>が言語バーから見えるリストから削除されてました。</p>

<p>残った<strong>米国 インターナショナルキーボード</strong>はどうしたものかと思ってましたが、
もう一度<strong>English (United States)</strong>を加え、
オプションに行きキーボードの追加を見るとこのキーボードがを発見。
これを追加した状態にしてから
<strong>English (United States)</strong>を削除するとこのキーボードも消えました。</p>

<p><img src="https://rcmdnk.com/images/post/20171124_optionen.png" alt="optionen" class="pic" /></p>

<p>ちょっとトリッキーですが、勝手に追加されたものの、設定上は追加されてないようになっていたために
削除することも出来ない状態で、
一回追加することでその設定が正規に登録されてそこからの削除で消える様になったみたいです。</p>

<p>Google日本語入力だけになるとタスクバーでの表示も変わって
Google日本語入力のアイコンが無くなり<code>A</code>とか<code>あ</code>とかだけになります。</p>

<p><img src="https://rcmdnk.com/images/post/20171124_taskbar1.jpg" alt="taskbar1" class="pic" /></p>

<p>複数の入力があると</p>

<p><img src="https://rcmdnk.com/images/post/20171124_taskbar0.jpg" alt="taskbar0" class="pic" /></p>

<p>こんな感じでアイコンが出てきてそのアイコンを押すと上にあるように
現在有効になってる入力一覧が表示されます。</p>

<p>1つしか入れてないのであれば確認する必要もないだろ、ということなのかもしれませんが、
べつにあっても良いとは思うのですが。</p>

<p>逆に言うとここに入力言語のアイコンが表示されてれば複数の入力言語があって
切り替わる可能性があるので調べて見る必要があります。</p>

<h2 id="入力言語を切り替えないようにする">入力言語を切り替えないようにする</h2>

<p>今回はなんとか解決方法をみつけましたが、もしどうしても消せない時は
入力言語切り替えを防ぐ様にする必要があります。</p>

<p>入力言語切り替えは<i class="key Alt">左</i>-<i class="key">Shift</i>を押すと切り替わる様になっています。</p>

<p>コントロールパネルの<strong>時計、言語、および地域</strong><i class="fa fa-arrow-right"></i><strong>言語</strong>
からさらに<strong>詳細設定</strong>に行くと
<strong>言語バーのホットキーの変更</strong>とうリンクがあるのでそれを出します。</p>

<p><img src="https://rcmdnk.com/images/post/20171124_langdetails.png" alt="langdetails" class="pic" /></p>

<p>そうすると
<strong>テキストサービスと入力言語</strong>
の<strong>キー詳細設定</strong>が呼び出され<strong>入力言語のホットキー</strong>を設定することが出来ます。</p>

<p><img src="https://rcmdnk.com/images/post/20171124_keyconfig.png" alt="keyconfig" class="pic" /></p>

<p>ここの<strong>入力言語を切り替える</strong>のキーをダブルクリックしてキーを無効化(Backspaceを押す)すれば
切り替わらなくなります。</p>

<p><i class="key Alt">左</i>-<i class="key">Shift</i>は結構何かの拍子で押してしまうので
気づかないうちに変わってしまう事があると思います。</p>

<p>アプリごとに切り替わったりもするのはどうしようもないですが、
多分、通常最初は1番上のものになっていて、
アプリで作業中に切り替えを行って他に行って戻った時に気付く、という感じなので
そもそも切り替えられなければ問題は起こりにくいはずです。</p>

<p>もちろん、使わないものなので削除できれば1番良いのですが。</p>

<h2 id="まとめ">まとめ</h2>

<p>設定を見ると加えてないはずのものが実際には加わっていて削除もできない状態になっていて、
設定から改めて加えると削除できる様になる、という状態でした。
バグだと思いますが同じ様な現象が他にも起こってるかもしれません。</p>

<p>Macでもちょっと違う現象ですがGoogle日本語入力だけを使おうとすると
USキーボードが入ってしまってこれも入力切替でじゃまになる、
という現象があります。
このUSキーボードをそのままだと消せないのですが、
Macの日本語入力(ことえり)を追加することでUSを消すことが出来、
その後何故か日本語入力も消せるのでGoogle日本語入力だけ残せる、という。</p>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail">
  <a href="https://rcmdnk.com/blog/2014/05/23/computer-mac/"><img class="small-thumbnail-img" src="https://rcmdnk.com/images/post/thumbnail/20140523_mac_ime_1_120_90.jpg" width="120" height="90" alt="20140523_mac_ime_1_120_90" /></a>
</div><a class="click_box_link" href="https://rcmdnk.com/blog/2014/05/23/computer-mac/">Macで入力ソースにいつの間にかU.S.が入ってきて消せない時の対処法</a></div></li></ul>

<p>言語周りはローカルな話で小さなバグが有っても見つかりにくく
直しづらいところなんだとは思いますが、
WindowsでもMacでも結構色々悩む事があります。
(そして何故かトリッキーな形で解決出来ることが多い…)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[vim_ahkで有効にするアプリの変更もメニューから出来る様にした]]></title>
    <link href="https://rcmdnk.com/blog/2017/11/14/computer-windows-autohotkey/"/>
    <updated>2017-11-14T00:00:00+00:00</updated>
    <id>https://rcmdnk.com/blog/2017/11/14/computer-windows-autohotkey</id>
    <content type="html"><![CDATA[<p><a href="https://github.com/rcmdnk/vim_ahk">vim_ahk</a>
の設定にアプリの変更も出来る様にしました。</p>

<p>これでスクリプトをいじらずに有効にしたいアプリを変更できますし、
<code>exe</code>ファイルとして実行したときも変更が可能になりました。</p>

<!-- more -->

<ul id="markdown-toc">
  <li><a href="#vim_ahkの設定" id="markdown-toc-vim_ahkの設定">vim_ahkの設定</a></li>
  <li><a href="#window-groupを実行中に変更する" id="markdown-toc-window-groupを実行中に変更する">Window Groupを実行中に変更する</a></li>
  <li><a href="#設定ファイルに改行のある文字列を書き出すと上手くいかない" id="markdown-toc-設定ファイルに改行のある文字列を書き出すと上手くいかない">設定ファイルに改行のある文字列を書き出すと上手くいかない</a></li>
  <li><a href="#edit枠を最初に持ってくるとフォーカス状態になる" id="markdown-toc-edit枠を最初に持ってくるとフォーカス状態になる">Edit枠を最初に持ってくるとフォーカス状態になる</a></li>
</ul>
<div class="group"></div>

<div class="center_wrapper">
  <div>Sponsored Links</div>
  <div>
  <ins class="adsbygoogle google-img-rect" style="display:inline-block" data-ad-client="ca-pub-3802317723662375" data-ad-slot="7116417646"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  </div>
</div>

<h2 id="vim_ahkの設定">vim_ahkの設定</h2>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail">
  <a href="https://rcmdnk.com/blog/2017/11/11/computer-windows-autohotkey/"><img class="small-thumbnail-img" src="https://rcmdnk.com/images/post/thumbnail/20171111_vimahksettings_120_90.png" width="120" height="90" alt="20171111_vimahksettings_120_90" /></a>
</div><a class="click_box_link" href="https://rcmdnk.com/blog/2017/11/11/computer-windows-autohotkey/">vim_ahkでメニューから設定変更出来る様にした</a></div></li></ul>

<p>この前チェックボックスなどを使ってメッセージのverbose levelなどを変更したり
出来る様にしましたが設定を有効に出来る
アプリの選択も出来る様にしました。</p>

<p><img src="https://rcmdnk.com/images/post/20171114_vimahksettings.jpg" alt="vimahksettings" class="pic" /></p>

<p>こんな感じのEdit枠を作って、各行に一つアプリのタイトルとかクラスとかを書きます。</p>

<blockquote>
  <p><a href="https://autohotkey.com/docs/misc/WinTitle.htm">WinTitle &amp; Last Found Window</a></p>
</blockquote>

<p>クラス名とかはトレイアイコンの右クリックから開ける<strong>Window Spy</strong>で調べられます。</p>

<h2 id="window-groupを実行中に変更する">Window Groupを実行中に変更する</h2>

<p>AutoHotkeyでは</p>

<figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="ahk"><span class="line"><span></span><span class="nb">GroupAdd</span><span class="p">,</span> <span class="n">VimGroup</span><span class="p">,</span> <span class="n">ahk_exe</span> <span class="n">notepad</span><span class="o">.</span><span class="n">exe</span>
</span><span class="line"><span class="nb">GroupAdd</span><span class="p">,</span> <span class="n">VimGroup</span><span class="p">,</span> <span class="n">ahk_exe</span> <span class="n">wordpad</span><span class="o">.</span><span class="n">exe</span>
</span></code></pre></td></tr></table></div></figure>

<p>の様にグループを設定して、</p>

<figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="ahk"><span class="line"><span></span><span class="n">#If</span> <span class="nf">WInActive</span><span class="p">(</span><span class="s">&quot;ahk_group VimGroup&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>

<p>または</p>

<figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="ahk"><span class="line"><span></span><span class="nb">#IfWInActive</span><span class="p">,</span> <span class="n">ahk_group</span> <span class="n">VimGroup</span>
</span></code></pre></td></tr></table></div></figure>

<p>の様にしてグループでまとめてそれがアクティブかどうかのチェックをしたり出来ます。</p>

<p>ただAutoHotkeyには<code>GroupAdd</code>はありますが、<code>GroupDelete</code>の様な
グループから除く様なコマンドはありません。
なのでグループを一度実行してから変更することは、加えることは簡単ですが
削除することは簡単にはできません。</p>

<p>そこで、名前に番号を付けてグループを変更するたびに番号を変更して
新しいグループとして作成し、
<code>IfWinActive</code>でもその名前でチェックする様にするとグループ変更が可能になります。</p>

<blockquote>
  <p><a href="https://autohotkey.com/board/topic/71695-is-there-any-way-to-destroy-delete-a-window-group/#entry455084">Is there any way to destroy (delete) a window group - Ask for Help - AutoHotkey Community</a></p>
</blockquote>

<p>vim_ahkの中では下記の様な感じでやっています。</p>

<figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
</pre></td><td class="code"><pre><code class="ahk"><span class="line"><span></span><span class="o">...</span>
</span><span class="line"><span class="n">VimGroupDel</span> <span class="o">:=</span> <span class="s">&quot;,&quot;</span>
</span><span class="line"><span class="n">VimGroupN</span> <span class="o">:=</span> <span class="mi">0</span>
</span><span class="line">
</span><span class="line"><span class="n">VimGroupIni</span> <span class="o">:=</span> <span class="s">&quot;ahk_exe notepad.exe&quot;</span><span class="c1">   ; NotePad</span>
</span><span class="line"><span class="n">VimGroupIni</span> <span class="o">:=</span> <span class="n">VimGroupIni</span> <span class="o">.</span> <span class="n">VimGroupDel</span> <span class="o">.</span> <span class="s">&quot;ahk_exe wordpad.exe&quot;</span><span class="c1">   ; WordPad</span>
</span><span class="line"><span class="n">VimGroupIni</span> <span class="o">:=</span> <span class="n">VimGroupIni</span> <span class="o">.</span> <span class="n">VimGroupDel</span> <span class="o">.</span> <span class="s">&quot;ahk_exe TeraPad.exe&quot;</span><span class="c1">   ; TeraPad</span>
</span><span class="line"><span class="o">...</span>
</span><span class="line"><span class="n">VimGroup</span> <span class="o">:=</span> <span class="n">VimGroupIni</span>
</span><span class="line"><span class="o">...</span>
</span><span class="line"><span class="n">VimReadIni</span><span class="p">()</span>
</span><span class="line"><span class="o">...</span>
</span><span class="line"><span class="n">VimSetGroup</span><span class="p">()</span>
</span><span class="line"><span class="o">...</span>
</span><span class="line"><span class="nb">Return</span>
</span><span class="line"><span class="o">...</span>
</span><span class="line"><span class="n">VimSetGroup</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="nb">global</span>
</span><span class="line">  <span class="n">VimGroupN</span><span class="o">++</span>
</span><span class="line">  <span class="n">VimGroupName</span> <span class="o">:=</span> <span class="s">&quot;VimGroup&quot;</span> <span class="o">.</span> <span class="n">VimGroupN</span>
</span><span class="line">  <span class="nb">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">VimGroup</span><span class="p">,</span> <span class="o">%</span> <span class="n">VimGroupDel</span>
</span><span class="line">  <span class="p">{</span>
</span><span class="line">    <span class="n">if</span><span class="p">(</span><span class="nv">A_LoopField</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">){</span>
</span><span class="line">      <span class="nb">GroupAdd</span><span class="p">,</span> <span class="nv">%VimGroupName%</span><span class="p">,</span> <span class="nv">%A_LoopField%</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="o">...</span>
</span><span class="line"><span class="n">#If</span> <span class="nf">WInActive</span><span class="p">(</span><span class="s">&quot;ahk_group &quot;</span> <span class="o">.</span> <span class="n">VimGroupName</span><span class="p">)</span>
</span><span class="line"><span class="o">...</span>
</span></code></pre></td></tr></table></div></figure>

<p><code>VimGroupN</code>という番号を新しくグループを作るたびに更新して
<code>VimGroupName</code>を新しくしています。
<code>#If WInActive</code>の中でも<code>VimGroupName</code>という変数を使っているので
<code>VimSetGroup</code>の中で変更されるとそこも反映されます。</p>

<h2 id="設定ファイルに改行のある文字列を書き出すと上手くいかない">設定ファイルに改行のある文字列を書き出すと上手くいかない</h2>

<p>上の例で<code>VimGroupDel</code>という変数でアプリの区切りを指定してますが、
Guiでは全て改行で区切る様に表示しています。</p>

<p>実際、Settingsに表示する時に<code>StringReplace</code>を使って
書き換えを行っていますが、
最初は改行の入った文字列のまま書き出してました。</p>

<p>が、どうも上手く動かないと思って書き出されたファイルを見てみると
改行(<code>`n</code>)が空白になって、さらに次に書き込まれるものを
挟むような感じになってしまっていました。</p>

<figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="ini"><span class="line"><span></span><span class="na">VimGroup</span><span class="o">=</span><span class="s">ahk_exe notepad.exe`nahk_exe wordpad.exe`n,ahk_exe TeraPad.exe...</span>
</span><span class="line"><span class="na">VimRestoreIME</span><span class="o">=</span><span class="s">1</span>
</span><span class="line"><span class="na">VimJJ</span><span class="o">=</span><span class="s">0</span>
</span><span class="line"><span class="na">VimIcon</span><span class="o">=</span><span class="s">1</span>
</span><span class="line"><span class="na">VimVerbose</span><span class="o">=</span><span class="s">1</span>
</span></code></pre></td></tr></table></div></figure>

<p>みたいになって欲しいのですが、</p>

<figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="ini"><span class="line"><span></span><span class="na">VimGroup</span><span class="o">=</span><span class="s">ahk_exe notepad.exeVimRestoreIME=1</span>
</span><span class="line"><span class="na">VimJJ</span><span class="o">=</span><span class="s">0</span>
</span><span class="line"><span class="na">VimIcon</span><span class="o">=</span><span class="s">1</span>
</span><span class="line"><span class="na">VimVerbose</span><span class="o">=</span><span class="s">1</span>
</span><span class="line"><span class="na">ahk_exe wordpad.exe ahk_exe TeraPad.exe...</span>
</span></code></pre></td></tr></table></div></figure>

<p>みたいな感じになってました。</p>

<p>書き出すタイミングをSleepで間を開けてみたりしても上手く生きませんでした。</p>

<p>加えて読み込むときも既に改行ではないので駄目です。</p>

<p>ということで改行区切りをそのまま出力するのは辞めてコンマ区切りに変更して出すようにしました。</p>

<h2 id="edit枠を最初に持ってくるとフォーカス状態になる">Edit枠を最初に持ってくるとフォーカス状態になる</h2>

<p>今の設定では一番上にチェックボックスがありますが、
最初はアプリの設定を一番上に持ってきてました。</p>

<p>アプリの設定は<code>Edit</code>を使ってますがこれが一番上にあると
こんな感じで選択された状態になってしまいました。</p>

<p><img src="https://rcmdnk.com/images/post/20171114_vimahksettings0.png" alt="vimahksettings0" class="pic" /></p>

<p>この状態でも実際にフォーカスがあたってるのは下のボタンで
すぐに<i class="key">Return</i>を押すと<strong>OK</strong>を押します。</p>

<p>なので実質的には問題は無いのですが、
見た目的にあれなので順序を変えました。</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[vim_ahkでメニューから設定変更出来る様にした]]></title>
    <link href="https://rcmdnk.com/blog/2017/11/11/computer-windows-autohotkey/"/>
    <updated>2017-11-11T00:00:00+00:00</updated>
    <id>https://rcmdnk.com/blog/2017/11/11/computer-windows-autohotkey</id>
    <content type="html"><![CDATA[<p>Windows上のどこでもVimライクな動作を出来る様にする
<a href="https://github.com/rcmdnk/vim_ahk">vim_ahk</a>で
タスクトレイアイコンを右クリックして出て来るメニューから
設定変更を出来る様にしました。</p>

<!-- more -->

<ul id="markdown-toc">
  <li><a href="#vim_ahkでの設定方法" id="markdown-toc-vim_ahkでの設定方法">vim_ahkでの設定方法</a></li>
  <li><a href="#今後追加したいもの" id="markdown-toc-今後追加したいもの">今後追加したいもの</a></li>
</ul>
<div class="group"></div>

<div class="center_wrapper">
  <div>Sponsored Links</div>
  <div>
  <ins class="adsbygoogle google-img-rect" style="display:inline-block" data-ad-client="ca-pub-3802317723662375" data-ad-slot="7116417646"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  </div>
</div>

<h2 id="vim_ahkでの設定方法">vim_ahkでの設定方法</h2>

<p>vim_ahkはAutoHotkeyを使ったどこでもVimエミュレーターです。</p>

<div class="github-widget" data-repo="rcmdnk/vim_ahk"></div>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail">
  <a href="https://rcmdnk.com/blog/2013/08/03/computer-windows-autohotkey/"><img class="small-thumbnail-img" src="https://rcmdnk.com/images/post/thumbnail/20130723_AutoHotKey_120_90.jpg" width="120" height="90" alt="20130723_AutoHotKey_120_90" /></a>
</div><a class="click_box_link" href="https://rcmdnk.com/blog/2013/08/03/computer-windows-autohotkey/">Vim以外でVimする: Windows+AutoHotkey編</a></div></li></ul>

<p>AutoHotokeyスクリプトなのでファイルの中身を見て設定を変えて走らせる事も可能ですが、
起動中にトレイアイコンの右クリックメニューから設定変更の出来る設定画面を出せる様にしました。</p>

<p><img src="https://rcmdnk.com/images/post/20171111_vimahkmenu.png" alt="vimahkmenu" class="pic" /></p>

<p><img src="https://rcmdnk.com/images/post/20171111_vimahksettings.png" alt="vimahksettings" class="pic" /></p>

<p>この設定画面は<i class="key">Cmd</i>-<i class="key">Alt</i>-<i class="key">Shift</i>-<i class="key">V</i>でも起動可能です。</p>

<p>今設定できるものとしては</p>

<ul>
  <li>RestoreIME: チェックするとノーマルモードからインサートモードに戻る時に前のインサートモードの時のIMEの状態に戻す。
    <ul>
      <li>vim_ahkではIMEがONの時に<i class="key">ESC</i>を押すと自動でIMEをOFFにしてノーマルモードに入る。</li>
    </ul>
  </li>
  <li>JJ: チェックすると<i class="key">J</i><i class="key">J</i>と素早く打つことでノーマルモードに入れる様になる<sup id="fninref:1"><a href="#fnin:1" rel="footnote">1</a></sup>。</li>
  <li>Icon: チェックするとトレイアイコンをモードによって変更する。</li>
  <li>Verbose: モード切替時の表示、0: 何もなし、1: モード名だけのToolTip、2: 詳しいToolTip、3: Msgbox表示(デバッグ用)</li>
</ul>

<p>これらの設定はスクリプトを消しても保存され
次の起動時に自動的に読み込まれて反映されます。
(スクリプトを直接変更しても保存したものの方が優先されます。)</p>

<p>保存先の設定ファイルは<strong>C:\Users&lt;USER&gt;\AppData\Roaming\AutoHotokey\vim_ahk.ini</strong>にあります。</p>

<p>ついでに<strong>vim_ahkについて</strong>的な<strong>About vim_ahk</strong>も作ってみました。</p>

<p><img src="https://rcmdnk.com/images/post/20171111_vimahkabout.png" alt="vimahkabout" class="pic" /></p>

<p>この辺を作るために調べた事は前回までにまとめましたが
AutoHotkeyではこの様なことをするためのツールが一通り整ってるため
結構簡単に色々な事が出来ます。</p>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail">
  <a href="https://rcmdnk.com/blog/2017/11/06/computer-windows-autohotkey/"><img class="small-thumbnail-img" src="https://rcmdnk.com/images/post/thumbnail/20130723_AutoHotKey_120_90.jpg" width="120" height="90" alt="20130723_AutoHotKey_120_90" /></a>
</div><a class="click_box_link" href="https://rcmdnk.com/blog/2017/11/06/computer-windows-autohotkey/">AutoHotkeyでのメニューの追加</a></div></li></ul>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail">
  <a href="https://rcmdnk.com/blog/2017/11/07/computer-windows-autohotkey/"><img class="small-thumbnail-img" src="https://rcmdnk.com/images/post/thumbnail/20171107_ahkguiinput0_120_90.png" width="120" height="90" alt="20171107_ahkguiinput0_120_90" /></a>
</div><a class="click_box_link" href="https://rcmdnk.com/blog/2017/11/07/computer-windows-autohotkey/">AutoHotkeyでのGUI操作</a></div></li></ul>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail">
  <a href="https://rcmdnk.com/blog/2017/11/08/computer-windows-autohotkey/"><img class="small-thumbnail-img" src="https://rcmdnk.com/images/post/thumbnail/20171108_ahkini0_120_90.png" width="120" height="90" alt="20171108_ahkini0_120_90" /></a>
</div><a class="click_box_link" href="https://rcmdnk.com/blog/2017/11/08/computer-windows-autohotkey/">AutoHotkeyで設定ファイルの読み書きをする</a></div></li></ul>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail">
  <a href="https://rcmdnk.com/blog/2017/11/10/computer-windows-autohotkey/"><img class="small-thumbnail-img" src="https://rcmdnk.com/images/post/thumbnail/20171110_ahktooltip_120_90.jpg" width="120" height="90" alt="20171110_ahktooltip_120_90" /></a>
</div><a class="click_box_link" href="https://rcmdnk.com/blog/2017/11/10/computer-windows-autohotkey/">AutoHotkeyでToolTipを出す</a></div></li></ul>

<h2 id="今後追加したいもの">今後追加したいもの</h2>

<p>今後追加したい設定項目として
vim_ahkを有効にするアプリの変更があります。</p>

<p>ただ、アプリ群を定義する<code>GroupAdd</code>というコマンドはあるのですが
アプリを取り除く<code>GroupDelete</code>的なコマンドがないので起動中に再定義するのが結構大変。</p>

<p>可能性としては、<code>Group1</code>、<code>Group2</code>…みたいにグループ名自体を変えていってしまう方法。</p>

<blockquote>
  <p><a href="https://autohotkey.com/board/topic/8613-removing-windows-from-a-group-or-deleting-a-group/">Removing windows from a group or deleting a group ? - Ask for Help - AutoHotkey Community</a></p>
</blockquote>

<blockquote>
  <p><a href="https://autohotkey.com/board/topic/71695-is-there-any-way-to-destroy-delete-a-window-group/">Is there any way to destroy (delete) a window group - Ask for Help - AutoHotkey Community</a></p>
</blockquote>

<p>もしくは起動中の削除は諦めて再起動時にだけ減らせる様にすればまあ可能かも。</p>

<p>もう一つ、メニューから現在のウィンドウが対応してるかどうか、
というチェックを行える様にしたかったんですが、
トレイアイコンを右クリックした時点でウィンドウの判定が
なくなるためか上手くいってません。
直前のウィンドウ、てきなものあったりしますが思った通りに動かず。
取り敢えずショートカットキーへの割当でできそうではありますが
ちょっと試してるところです。</p>
]]></content>
  </entry>
  
</feed>
