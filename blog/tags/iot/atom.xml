<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: IoT | rcmdnk's blog]]></title>
  <link href="https://rcmdnk.com/blog/tags/iot/atom.xml" rel="self"/>
  <link href="https://rcmdnk.com/"/>
  <updated>2021-12-19T00:44:13+00:00</updated>
  <id>https://rcmdnk.com/</id>
  <author>
    <name><![CDATA[rcmdnk]]></name>
    <email><![CDATA[rcmdnk@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Oura Ring Generation 3が届いた]]></title>
    <link href="https://rcmdnk.com/blog/2021/12/15/computer-iot-shopping/"/>
    <updated>2021-12-15T00:00:00+00:00</updated>
    <id>https://rcmdnk.com/blog/2021/12/15/computer-iot-shopping</id>
    <content type="html"><![CDATA[<p>先月注文していたOura RingのGeneration 3が届きました。</p>

<!-- more -->

<ul id="markdown-toc">
  <li><a href="#oura-ring-generation-3" id="markdown-toc-oura-ring-generation-3">Oura Ring Generation 3</a></li>
  <li><a href="#dhlによる配達" id="markdown-toc-dhlによる配達">DHLによる配達</a></li>
  <li><a href="#到着品" id="markdown-toc-到着品">到着品</a></li>
  <li><a href="#1年使ってみたリングの傷" id="markdown-toc-1年使ってみたリングの傷">1年使ってみたリングの傷</a></li>
  <li><a href="#generation-2から3への切り替え" id="markdown-toc-generation-2から3への切り替え">Generation 2から3への切り替え</a></li>
  <li><a href="#generation-3の機能" id="markdown-toc-generation-3の機能">Generation 3の機能</a></li>
  <li><a href="#a-free-lifetime-membership" id="markdown-toc-a-free-lifetime-membership">A free lifetime membership</a></li>
  <li><a href="#まとめ" id="markdown-toc-まとめ">まとめ</a></li>
</ul>
<div class="group"></div>

<div class="center_wrapper">
  <div>
  <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3802317723662375" data-ad-slot="5762198341"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  </div>
</div>

<h2 id="oura-ring-generation-3">Oura Ring Generation 3</h2>

<p>10月末くらいにOura Ringの新しいバージョンが出来たというお知らせが来ていて、
すぐに購入すれば割引と新しく導入される月額会員の障害無料特典が付くということで早速申し込んでみました。</p>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail"><div class="amazon-img">
  <a href="//www.amazon.co.jp/gp/product/B07XF4XT9Q?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B07XF4XT9Q&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank"><img src="https://images-na.ssl-images-amazon.com/images/I/61etlVTj08L._SS90_CR0,0,120,90_.jpg" alt="Oura Ring オーラリング Balance&nbsp;model US9 Black 【アプリ日本語対応！NextSims】" /></a>
</div></div><a class="click_box_link" href="https://rcmdnk.com/blog/2021/11/01/computer-iot-shopping/">Oura Ring Generation 3を購入(a free lifetime Oura membership)</a></div></li></ul>

<p>11月1日に申し込みました。
まずはsizing kitが送られてきてサイズを確定して本体が送られてくるという仕組み。
この時点では15日位にリングの最初のスロットが発送される、という予定でした。</p>

<p>申込みはそれほど早い段階ではなかったですが、11日にsizing kitが発送され、15日に到着。
すでにGeneration 2で丁度よいサイズ感は得ていて、試しにひとつ上、下をはめてみましたがやはり
今のものが明らかに丁度よいのですぐに同じサイズで申し込みをしました。</p>

<p>ちょうどこの頃にリング自体の発送が始まる予定でしたが、16日にたくさん注文が来たので
ちょっと遅れるかもしれません、というメールが来ていました。</p>

<p>そんなわけでちょっとまっていたわけですが、12月9日に発送されて本日届きました!</p>

<h2 id="dhlによる配達">DHLによる配達</h2>

<p>配達は例によってDHLによって行われてきます。</p>

<p>登録してあるメールアドレスや携帯のSMSとかに発送の連絡や受け取り方指定の変更など色々
送ってくれますが、
特にこの様な海外で買ったものには関税がかかることがあり、今回も関税の支払いがありました。</p>

<p>前回買った時は受取時に現金での支払が必要でしたが、今回は事前にカードでの支払いが可能でした。</p>

<p><img src="https://rcmdnk.com/images/post/20211215_dhl.jpg" alt="20211215_dhl.jpg" class="pic" /></p>

<p>上の様なものが貼られてたのでコロナ禍から始まったサービスかとは思いますが、
現金を殆ど使わない昨今、丁度よい現金を用意しておかなきゃ、とちょっと面倒だったので
これは嬉しいサービスです。</p>

<p>(ただ、前日までに受け取り時間の指定とか関税の金額だけのお知らせが来ていて、
カードで払って、というお知らせは当日に急に来たので実はちゃんと丁度よい金額を用意していたという。。。
まあそれでも受取時に払うよりはスムーズだったとは思います。)</p>

<p>後、多分関税を先に払ってあれば、宅配ボックスとかにも置いていってくれるので、
その点はだいぶ便利になるかと。
(在宅だったので受け取りましたが。)</p>

<p>ちなみに、金額は前回は2800円だったのですが、今回は2600円でした。</p>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail"><div class="amazon-img">
  <a href="//www.amazon.co.jp/gp/product/B07XF4XT9Q?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B07XF4XT9Q&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank"><img src="https://images-na.ssl-images-amazon.com/images/I/61etlVTj08L._SS90_CR0,0,120,90_.jpg" alt="Oura Ring オーラリング Balance&nbsp;model US9 Black 『アプリ日本語対応！』" /></a>
</div></div><a class="click_box_link" href="https://rcmdnk.com/blog/2021/01/12/computer-iot-shopping/">Oura Ring(スマートリング、ウェアラブルデバイス)を購入した</a></div></li></ul>

<p>リングの値段が前回$299だったのが今回は割引で
$249だったのでその分もあるでしょうが、税率も変わった感じ。</p>

<p>いずれにしろこれで新規購入にかかったお金は</p>

<ul>
  <li>Ring代: $299</li>
  <li>Shipping: $15</li>
  <li>早期割引: -$50</li>
  <li>Sizing Kit: $5</li>
  <li>Sizing Kit割引: -$5</li>
  <li>関税: 2,600円</li>
</ul>

<p>で大体30,900円位になりました。</p>

<h2 id="到着品">到着品</h2>

<p>というわけで届いたのはこんな感じ。</p>

<p>どちらがGeneration 3か?</p>

<p><img src="https://rcmdnk.com/images/post/20211215_oura3.jpg" alt="20211215_oura3.jpg" class="pic" /></p>

<p>左がGeneration 2で右が3の箱です。</p>

<p>3では平べったくなりました。</p>

<p>中にはこんな感じで入ってます。</p>

<p><img src="https://rcmdnk.com/images/post/20211215_oura1.jpg" alt="20211215_oura1.jpg" class="pic" /></p>

<p>充電器のケーブルがなんかカッコいい感じに入ってました。
(前は白い紙素材でまとめられてただけだった。)</p>

<p>リングは以前と同じBlackを選びましたが、実物を見るとほとんど違いがわからないくらいです。</p>

<p><img src="https://rcmdnk.com/images/post/20211215_oura2.jpg" alt="20211215_oura2.jpg" class="pic" /></p>

<p>上の写真では右が3。</p>

<p><img src="https://rcmdnk.com/images/post/20211215_oura4.jpg" alt="20211215_oura4.jpg" class="pic" /></p>

<p>上の写真では左が3ですが、3の方にはちゃんと<code>GEN3</code>の文字が入っています。</p>

<p><img src="https://rcmdnk.com/images/post/20211215_oura5.jpg" alt="20211215_oura5.jpg" class="pic" /></p>

<p>センサーの方はこんな感じ。これも左が3。
2に比べて金色の金具が減って落ち着いた感じ?に。</p>

<p>センサーも色々変わっているようですが、大きく3つの突起があるのは2と同じ。</p>

<p>実際に指にはめてみた感じですが、新しいほうが少しスカスカしている感じがしました。
充電器に付けてみた感じも2の方が少しひっかかりがある感じがするので実際に少し穴が大きいようです。
突起の部分の違いかな?程度ですが。
ひとつ上のサイズ、という程の違いでは全然ないです。</p>

<p>また、見た目ではほとんどわからなかったですが、
触った感じや下にある写真の様に平らな部分で立てて見るとわかるのですが、
手の外側に来る平らな部分が少し丸みがましてよりなめらかな形になっていました。</p>

<h2 id="1年使ってみたリングの傷">1年使ってみたリングの傷</h2>

<p>結構きれいな指輪なので傷付くのは嫌だな、と思いつつ、でもそれに気をつけて生活するのはもっと嫌だな、ということで
ぶつかったりしてもあまり気にせず使ってきましたが、
1年ほど経った結果がこれ。</p>

<p><img src="https://rcmdnk.com/images/post/20211215_oura7.jpg" alt="20211215_oura7.jpg" class="pic" /></p>

<p>左が新しい無傷の3で右が1年経った2。</p>

<p>こうやって見ると少し傷があるのが分かりますが、こちら手の内側に入る方で、
反対の外側に来る平らな方は上の写真にちょっとありますがあまり傷はありません。</p>

<p>内側の方がコップ持ったりする時にも当たるのでそのせいだとは思いますが、
この内側の傷も普通に見る分にはほとんど気にならないです。
この辺は色次第な気もしますが、割と黒のこのつや消ししてないものが一番傷目立つんじゃないかと思うので
そんなに傷は気にしないで良いかも、と。</p>

<p>5年とか使うと流石に傷が目立ちそうですが、その頃にはバッテリーの問題とかもあって
ウェアラブルデバイスとしては使えなくなっているのでは、とも。</p>

<p>そんな感じで傷とかはあまり考えずに普通に生活して大丈夫かな、という結論です。</p>

<h2 id="generation-2から3への切り替え">Generation 2から3への切り替え</h2>

<p><a href="https://support.ouraring.com/hc/ja/articles/4411128662291-%E7%AC%AC3%E4%B8%96%E4%BB%A3%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97">第3世代リングのセットアップ – Oura ヘルプ</a></p>

<p>に従って。</p>

<p>アプリの<strong>設定</strong>に行くとこんな感じで新しいリングへのアップグレードの方法へのリンクも出ています。</p>

<p><img src="https://rcmdnk.com/images/post/20211215_oura6.jpg" alt="20211215_oura6.jpg" class="pic" /></p>

<p>これをしただけだとBluetoothのところにデバイスが残っているので
それだけ後でBlutoothの設定に行ってつながってない古い方のoura_XXXXを削除する必要があります。
(しなくても特に問題ないとは思いますが。)</p>

<p>アップデートするとアプリも自動的にアップグレードされ、
同じ設定メニューがこんな感じに。</p>

<p><img src="https://rcmdnk.com/images/post/20211215_oura8.jpg" alt="20211215_oura8.jpg" class="pic" /></p>

<p>全般にあった<strong>スリープサウンド</strong>が消えて<strong>生理予測</strong>が入っています。</p>

<p><strong>スリープサウンド</strong>はHome画面の右下に出来た<strong>探索</strong>というメニューに移ったようです。</p>

<h2 id="generation-3の機能">Generation 3の機能</h2>

<p>生理予測(Period Prediction)はまだβ版ですがiOSではすでに試せるようです。</p>

<p>その他色々な機能が追加される予定ですが、まだ今後ソフトウェア・アップデートで追加されるものもあります。</p>

<p><a href="https://ouraring.com/blog/oura-generation2-vs-generation3/">Introducing the New Oura Ring Generation 3 - The Pulse Blog</a></p>

<p><a href="https://support.ouraring.com/hc/en-us/articles/4409072131091">The Difference Between the Gen2 and Gen3 Oura Rings – Oura Help</a></p>

<p>運動中の心拍数とか、動脈血酸素飽和度(SpO2)測定とかはまだこれからのようです。</p>

<p>運動時の心拍数を細かく取ることはまだ出来ないようですが、
これまで取れなかった起きている間の通常時の心拍数は記録されるようになりました。</p>

<p><img src="https://rcmdnk.com/images/post/20211215_oura9.jpg" alt="20211215_oura9.jpg" class="pic" />
<img src="https://rcmdnk.com/images/post/20211215_oura10.jpg" alt="20211215_oura10.jpg" class="pic" /></p>

<p>夕方から付け始めたので右の方に一個だけついてますが、今後はこんな感じで昼間も計測が出来れば心拍数が記録されるようになります。</p>

<p>これを使ったりして、<strong>回復時間</strong>、というゆっくり落ち着いていた時間の観測もされるようです。</p>

<h2 id="a-free-lifetime-membership">A free lifetime membership</h2>

<p>Generation 3にアップグレード後のメニューには
<strong>メンバーシップを管理する</strong>という項目が追加されています。</p>

<p><img src="https://rcmdnk.com/images/post/20211215_oura8.jpg" alt="20211215_oura8.jpg" class="pic" /></p>

<p>そして、以前書いたようにGeneration 2を使っていて早期に申し込みした人は
life time membershipを手に入れることが出来、
ちゃんと登録出来たようで<strong>生涯メンバー</strong>と表示されています。</p>

<p>これで毎月$5.99が無料に。</p>

<p><a href="https://support.ouraring.com/hc/en-us/articles/4409072131091">The Difference Between the Gen2 and Gen3 Oura Rings – Oura Help</a></p>

<p>メンバーシップがなくてもGeneration 3は使えますが、一部の情報しか見れなくなるとのこと。</p>

<p>せっかく色々情報が得られる以上は最大限集めて自分を管理していきたいところです。
(とはいえ、現時点ではまだ余り新しい機能が追加されてないのでほとんど違いはない?感じもあったりします。)</p>

<h2 id="まとめ">まとめ</h2>

<p>Oura Ring Generation 3が届いて乗り換えましたが、
今の所新しく目についたのは起きてる間の心拍数の情報が出るようになったな、というところ。</p>

<p>センサーなどは新しくなっているようなので後はまだソフトウェア的な部分が追いついてないということで
今後に期待です。</p>

<p>まだ使い始めたばかりで気付けてない部分もあると思いますが、
また何か気付いたら追加で書こうかと思います。</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Oura Ring Generation 3を購入(a free lifetime Oura membership)]]></title>
    <link href="https://rcmdnk.com/blog/2021/11/01/computer-iot-shopping/"/>
    <updated>2021-11-01T00:00:00+00:00</updated>
    <id>https://rcmdnk.com/blog/2021/11/01/computer-iot-shopping</id>
    <content type="html"><![CDATA[<div class="amazon-img">
  <a href="//www.amazon.co.jp/gp/product/B07XF4XT9Q?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B07XF4XT9Q&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank"><img src="https://images-na.ssl-images-amazon.com/images/I/61etlVTj08L._SS200_.jpg" alt="Oura Ring オーラリング Balance&nbsp;model US9 Black 【アプリ日本語対応！NextSims】" /></a>
</div>

<p>Oura Ringの新しいバージョンが出来たというお知らせが来て、
11月9日までに新しいものを購入したら色々特典がある、
というのに釣られて購入しました。</p>

<!-- more -->

<ul id="markdown-toc">
  <li><a href="#oura-ring" id="markdown-toc-oura-ring">Oura Ring</a></li>
  <li><a href="#oura-ring-generation-3" id="markdown-toc-oura-ring-generation-3">Oura Ring Generation 3</a></li>
  <li><a href="#第2世代保持者へのオファー" id="markdown-toc-第2世代保持者へのオファー">第2世代保持者へのオファー</a></li>
  <li><a href="#50オフオファー" id="markdown-toc-50オフオファー">$50オフオファー</a></li>
</ul>
<div class="group"></div>

<div class="center_wrapper">
  <div>
  <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3802317723662375" data-ad-slot="5762198341"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  </div>
</div>

<h2 id="oura-ring">Oura Ring</h2>

<p>Oura Ringは指輪型のウェアラブルデバイスです。</p>

<p>睡眠時間や日中の体温などを測定して健康状態を観測してくれます。</p>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail"><div class="amazon-img">
  <a href="//www.amazon.co.jp/gp/product/B07XF4XT9Q?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B07XF4XT9Q&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank"><img src="https://images-na.ssl-images-amazon.com/images/I/61etlVTj08L._SS90_CR0,0,120,90_.jpg" alt="Oura Ring オーラリング Balance&nbsp;model US9 Black 『アプリ日本語対応！』" /></a>
</div></div><a class="click_box_link" href="https://rcmdnk.com/blog/2021/01/12/computer-iot-shopping/">Oura Ring(スマートリング、ウェアラブルデバイス)を購入した</a></div></li></ul>

<p>腕時計型や腕輪型のものは多くありますが、指輪型ではOura Ringが一番有名だと思います。
腕輪型よりも指に接触率が高い分データ取得も良いとか。</p>

<p>何れにしろ、時計は好きなのを付けたいということもあった指輪型はかなり良いです。</p>

<p>ということで1年くらい前に買った訳ですが、かなり満足度が高くて買ってよかったと思ってます。</p>

<p>そんな中、新型が出るという話が。</p>

<blockquote>
  <p><a href="https://www.imore.com/oura-launches-third-generation-smart-ring-247-health-tracking-and-more">ŌURA launches third-generation Smart Ring with 24/7 health tracking and more  iMore</a></p>
</blockquote>

<p>初代が2017年頃に作られて、2018年に今の第二世代が発売開始されたので、
第2世代からは3年ちょっと経っての新世代です。</p>

<p>初代に比べて第2世代はだいぶスマートに小さくなったようですが、
第3世代は大きさはそのままに機能拡張されている、といった感じだそうです。</p>

<h2 id="oura-ring-generation-3">Oura Ring Generation 3</h2>

<blockquote>
  <p><a href="https://ouraring.com/blog/oura-generation2-vs-generation3/">Introducing the New Oura Ring Generation 3 - The Pulse Blog</a></p>
</blockquote>

<p>色々とセンサーが新しくなるようで、
これまで睡眠時のみ測定していた心拍数を日中にも測定し、
運動をしているときの測定も出来るようになります。</p>

<p>また、体温センサーなどもアップグレードされたり
SpO2 (動脈血酸素飽和度)の測定など出来るようになるとのことです。</p>

<p>これらの一部は今後のアップグレードでソフトウェア的に可能になるものもあるようですが、
第2世代ではできなかった測定が可能になるようです。</p>

<p>また、女性の月経周期の追跡などの機能も加わるようです。</p>

<p>そんな中、お値段は第2世代と同じ$299。</p>

<p>ただし、シルバー、ブラックがその値段で、Stealth(マッド仕上げのブラック)とゴールドは
$399です。</p>

<p>これらは以前も高かったので基本的に機能が上がってお値段据え置き、といった感じ。</p>

<p>サイズも第2世代と同じとのこと。</p>

<p>ということで、これから買う人は100%第3世代を買うことになるかと思います。</p>

<p>さらに、第3世代からは$6.99でのサブスクリプションによるより精度の高い情報提供が行われます。</p>

<p>月$6.99ですが、これは入らなくても基本的な測定は見れるとのこと。</p>

<p>また、第2世代のデバイスを持っている人はそのままサブスクなしにこれまでどおりの
測定値が見れるとのことです。</p>

<p>第3世代でサブスクに加入するとより詳細な分析結果が見れたりするとのこと。</p>

<h2 id="第2世代保持者へのオファー">第2世代保持者へのオファー</h2>

<p>この知らせを見たときに、いずれは第3世代を買うけど、前のを買ってからまだ1年経ってない段階なのでちょっと様子見か?とか思っていました。</p>

<p>が、第2世代を持っている人に対して、11月9日までに新しいデバイスを買うと
<strong>a free lifetime Oura membership</strong>のオファーが…</p>

<p>毎月$6.99がただになるので、3年半程使えばただに。
と思っていたら、さらに本体$50オフも11月9日まで、
ということでとりあえず買いました。</p>

<p>マッド仕上げの黒も試してみたかったんですが、今持ってるブラックの通常版でも
結構気に入ってるので$100プラスしなくても良いかな、ということで
またブラックを頼みました。</p>

<p>Sizing kitもまた無料で来るとのことで11月中旬にSizing kitが来て
それから本体を頼んでで11月後半には手に入るくらいな感じでしょうか?</p>

<p>まあ、第2世代でそのままサブスク使わずに使っていたら
1円もかからないわけですが、
今の状況にかなり満足していて次も数年以内には必ず買うと思ってるので、
であれば今買って
<strong>a free lifetime Oura membership</strong>のオファーと$50オフを手に入れるのが
最善だということで。</p>

<h2 id="50オフオファー">$50オフオファー</h2>

<p>現在はLifetime free membershipは既存のユーザーにのみ提供されていますが、
$50オフオファーは受けることが出来ます。</p>

<p>下記のリンクから12月1日までの間に購入すると$50オフで買うことが出来ます(3人まで)。</p>

<p>https://ouraring.com/taf/7993e86123</p>

<p>シルバー、ブラックなら$249、ステルス(マッドブラック)、
ゴールドなら$349です。</p>

<p>今迷っているならちょうど新しい第3世代のものが$50オフで買えるのでちょうどよいかと。</p>

<p>ちなみに上のリンクから3人買ってもらえると私がパーカーとかがもらえます(笑)</p>

<blockquote>
  <p><a href="https://get.ouraring.com/tellafriend">Give the Gift of Oura, Get Exclusive Apparel</a></p>
</blockquote>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MH-Z19CとRaspberry Pi Zeroで二酸化炭素濃度を測定する]]></title>
    <link href="https://rcmdnk.com/blog/2021/09/18/computer-iot-raspberrypi/"/>
    <updated>2021-09-18T00:00:00+00:00</updated>
    <id>https://rcmdnk.com/blog/2021/09/18/computer-iot-raspberrypi</id>
    <content type="html"><![CDATA[<div class="amazon-img">
  <a href="//www.amazon.co.jp/gp/product/B094XDFL34?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B094XDFL34&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank"><img src="https://images-na.ssl-images-amazon.com/images/I/71CEwRXKEoL._SS200_.jpg" alt="Liseng MH-Z19C IR赤外線CO2センサーモジュール二酸化炭素ガスセンサーNDIR、CO2モニター400-5Ppm UART PWM出力用" /></a>
</div>

<p>以前、MH-Z19BをRaspberry Pi Zeroにつなげて二酸化炭素を測定できる様にしましたが、
ちょっと問題があったので別途MH-Z19Cを買って入れ替えました。</p>

<!-- more -->

<ul id="markdown-toc">
  <li><a href="#以前の設定方法について" id="markdown-toc-以前の設定方法について">以前の設定方法について</a></li>
  <li><a href="#起こっていた問題" id="markdown-toc-起こっていた問題">起こっていた問題</a></li>
  <li><a href="#mh-z19c" id="markdown-toc-mh-z19c">MH-Z19C</a></li>
  <li><a href="#mh-z19bとmh-z19c" id="markdown-toc-mh-z19bとmh-z19c">MH-Z19BとMH-Z19C</a></li>
  <li><a href="#使用感" id="markdown-toc-使用感">使用感</a></li>
</ul>
<div class="group"></div>

<div class="center_wrapper">
  <div>
  <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3802317723662375" data-ad-slot="5762198341"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  </div>
</div>

<h2 id="以前の設定方法について">以前の設定方法について</h2>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail"><div class="amazon-img">
  <a href="//www.amazon.co.jp/gp/product/B08HD8XTZP?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B08HD8XTZP&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank"><img src="https://images-na.ssl-images-amazon.com/images/I/6156eNDPz2L._SS90_CR0,0,120,90_.jpg" alt="MH-Z19B ピン付き(二酸化炭素(CO2)センサーモジュール、0-5000ppm、赤外線方式(NDIR))" /></a>
</div></div><a class="click_box_link" href="https://rcmdnk.com/blog/2021/02/18/computer-iot-raspberrypi/">MH-Z19BとRaspberry Pi Zeroで二酸化炭素濃度を測定する</a></div></li></ul>

<p>こちらで。MH-Z19BとRaspberry Pi Zeroで二酸化炭素濃度を測定できる様にしました。</p>

<p>Pythonのスクリプトで読み取ってGoogle Sheetsに送ったり、
Blynkに送ってスマホから確認出来るようにしたりしています。</p>

<h2 id="起こっていた問題">起こっていた問題</h2>

<p>MH-Z19Bで測定を開始して割とすぐに測定が止まってしまうことがありました。
コマンドを送っても接続がうまく出来てないような状況。</p>

<p>Raspberry Pi自体を再起動したりしてもうまく接続できませんでした。</p>

<p>この問題は、MH-Z19BにつながっているVinのピンにつながっているコードを抜き差しすると解決しました。</p>

<p>その後、1週間に1回位起こる現象になっていて、正直常時使うには辛いレベルです。
Raspberry Piの再起動とか自動で復帰できればよいのですが、物理的に抜き差しすることしか
解決する方法は見つけれてない状態で。(その部分を外部からスイッチングできる様な装置使えば自動で復帰できるかもしれませんが。。。)</p>

<p>と、そんな中、上の記事に対して</p>

<blockquote>
  <p>画像のものは偽物ですね
私も偽のものを掴まされました…</p>
</blockquote>

<p>というコメントが。。。
ちょっとどこを見て判断するのかはわかりませんが、裏が緑ではなく黒いところとか？</p>

<p>これの真偽は正直わからないのですが、ただ、買ったサイトはAliExpressで、
偽物を掴まされたという話もちょくちょく聞く様なところだったですし、
届いたものも結構作りが雑な感じはしてました。</p>

<p><img src="https://rcmdnk.com/images/post/20210218_mhz19b1.jpg" alt="20210218_mhz19b1.jpg" class="pic" />
<img src="https://rcmdnk.com/images/post/20210218_mhz19b2.jpg" alt="20210218_mhz19b2.jpg" class="pic" /></p>

<p>それでもそれっぽい測定出来てたので、もしかしたら単なる個体差かもしれませんが、
いずれにしろ使いづらいので新しいものを買おう、と。</p>

<h2 id="mh-z19c">MH-Z19C</h2>

<p>とはいえ、またよくわからないものを掴まされても困るので、ちゃんとしたところから買いたいな、
と思って探していたところ、
MH-Z19Cの方を秋月電子通商が取り扱いを開始しているのを見つけました。</p>

<blockquote>
  <p><a href="https://akizukidenshi.com/catalog/g/gM-16142/">ＣＯ２センサーモジュール ＭＨ－Ｚ１９Ｃ: センサ一般 秋月電子通商-電子部品・ネット通販</a></p>
</blockquote>

<p>しかも現時点(2021/08/29)で税込み2 ,480円とAmazonとかより安い。
AliExpressを探すともう少し安いのもありますが、安心感が全然違います。
Amazonもよくわからないところしか販売してないですし。</p>

<p>残念ながらMH-Z19Bの取り扱いは現状内容ですが、下に書くように
特にMH-Z19Cでも困ることはなさそうなのでこれを買いました。</p>

<p><img src="https://rcmdnk.com/images/post/20210918_mhz19c1.jpg" alt="20210830_mhz19c1.jpg" class="pic" />
<img src="https://rcmdnk.com/images/post/20210918_mhz19c2.jpg" alt="20210830_mhz19c2.jpg" class="pic" /></p>

<p>こんな感じのきれいなものが手に入りました。。。</p>

<p>こちらのCの方は
表側の白いテープが張ってある部分も赤く光ります。
また、裏にも電源ランプみたいなものが付いていて、電源が入っていると
裏の電源の横とVinの横に付いているランプがチカチカと光ります。</p>

<p><img src="https://rcmdnk.com/images/post/20210918_mhz19c4.jpg" alt="20210830_mhz19c4.jpg" class="pic" /></p>

<p>ただこれは止められるなら止めたいな、とも思ったり。(嫌ならテープ貼っておくとかで処置するか、と。)</p>

<h2 id="mh-z19bとmh-z19c">MH-Z19BとMH-Z19C</h2>

<div class="amazon-box">
  <div class="amazon-img">
  <a href="//www.amazon.co.jp/gp/product/B08HD8XTZP?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B08HD8XTZP&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank"><img src="https://images-na.ssl-images-amazon.com/images/I/6156eNDPz2L._SS200_.jpg" alt="MH-Z19B ピン付き(二酸化炭素(CO2)センサーモジュール、0-5000ppm、赤外線方式(NDIR))" /></a>
</div>

  <div class="amazon-title">
    <a href="//www.amazon.co.jp/gp/product/B08HD8XTZP?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B08HD8XTZP&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank">MH-Z19B ピン付き(二酸化炭素(CO2)センサーモジュール、0-5000ppm、赤外線方式(NDIR))</a>
  </div>
  <div class="amazon-txt">
    <span class="amazon-link"><a href="//www.amazon.co.jp/gp/product/B08HD8XTZP?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B08HD8XTZP&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank">Amazonで見る</a></span>
    <span class="rakuten-link"><a href="//hb.afl.rakuten.co.jp/hgc/111f634c.5fb25e94.111f634d.1a56ae16/?pc=http%3A%2F%2Fsearch.rakuten.co.jp%2Fsearch%2Fmall%2FMH-Z19B+%2F&amp;m=http%3A%2F%2Fsearch.rakuten.co.jp%2Fsearch%2Fmall%2FMH-Z19B+%2F&amp;scid=af_url_txt&amp;link_type=text&amp;ut=eyJwYWdlIjoidXJsIiwidHlwZSI6InRlc3QiLCJjb2wiOjB9" rel="nofollow" target="_blank">楽天市場で見る</a></span>
  </div>
</div>

<blockquote>
  <p><a href="https://www.winsen-sensor.com/sensors/co2-sensor/mh-z19b.html">MH-Z19B ndir CO2 sensor for indoor air quality monitoring–Winsen</a></p>
</blockquote>

<blockquote>
  <p><a href="https://www.winsen-sensor.com/d/files/MH-Z19B.pdf">MH-Z19B データシート</a></p>
</blockquote>

<div class="amazon-box">
  <div class="amazon-img">
  <a href="//www.amazon.co.jp/gp/product/B08RMJQKW1?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B08RMJQKW1&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank"><img src="https://images-na.ssl-images-amazon.com/images/I/71CEwRXKEoL._SS200_.jpg" alt="Nrpfell MH-Z19C IR赤外線CO2センサーモジュール二酸化炭素ガスセンサーNDIR、CO2モニター400-5Ppm UART PWM出力用" /></a>
</div>

  <div class="amazon-title">
    <a href="//www.amazon.co.jp/gp/product/B08RMJQKW1?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B08RMJQKW1&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank">Nrpfell MH-Z19C IR赤外線CO2センサーモジュール二酸化炭素ガスセンサーNDIR、CO2モニター400-5Ppm UART PWM出力用</a>
  </div>
  <div class="amazon-txt">
    <span class="amazon-link"><a href="//www.amazon.co.jp/gp/product/B08RMJQKW1?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B08RMJQKW1&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank">Amazonで見る</a></span>
    <span class="rakuten-link"><a href="//hb.afl.rakuten.co.jp/hgc/111f634c.5fb25e94.111f634d.1a56ae16/?pc=http%3A%2F%2Fsearch.rakuten.co.jp%2Fsearch%2Fmall%2F+MH-Z19C%2F&amp;m=http%3A%2F%2Fsearch.rakuten.co.jp%2Fsearch%2Fmall%2F+MH-Z19C%2F&amp;scid=af_url_txt&amp;link_type=text&amp;ut=eyJwYWdlIjoidXJsIiwidHlwZSI6InRlc3QiLCJjb2wiOjB9" rel="nofollow" target="_blank">楽天市場で見る</a></span>
  </div>
</div>

<blockquote>
  <p><a href="https://www.winsen-sensor.com/sensors/co2-sensor/mh-z19c.html">MH-Z19C NDIR CO2 Sensor for HVAC and IAQ–Winsen</a></p>
</blockquote>

<blockquote>
  <p><a href="https://www.winsen-sensor.com/d/files/infrared-gas-sensor/mh-z19c-pins-type-co2-manual-ver1_0.pdf">MH-Z19C データシート</a></p>
</blockquote>

<p>見た目も似てますが、中身もかなり同じ様な感じになっています。</p>

<p>生えてるピンも同じなので、Raspberry Pi Zeroとの接続も同じです。
(BME280が余計に付いてますが気にせず。)</p>

<p><img src="https://rcmdnk.com/images/post/20210218_fritzing.jpg" alt="20210218_fritzing.jpg" class="pic" /></p>

<p>二酸化炭素を測定するために送る信号も2つとも同じです。
また、Self calibrationと呼ばれる自動キャリブレーション機能のon/offを行う信号も同じになっています。</p>

<p>違う信号として、MH-Z19Bには信号を送ることでキャリブレーションを即座に実行することが出来ますが、
MH-Z19Cのデータシートにはその信号は明記されていません。</p>

<p>ただ、この直接のキャリブレーションはHDピンとGNDピンをつなげれば行えます。(これは2つとも出来る。)</p>

<p>また、MH-Z19Cの方が後に発売されたものですが、測定範囲が
MH-Z19Bが0~5000ppm、MH-Z19Cが400~5000ppmとMH-Z19Bの方が広くなっています。</p>

<p>なので、MH-Z19CはMH-Z19Bの簡易版?的な感じもしますが、
単に余計な機能を落として安定させた、というものかもしれません。</p>

<p>いずれにしろ、既に開発されているMH-Z19B用の測定ツールなどは基本的にそのまま使うことが出来ます。</p>

<h2 id="使用感">使用感</h2>

<p>現在同時に2つ動かせる環境じゃないのでBからCに交換して動かしています。</p>

<p>1ヶ月ほど動かしていますが、今の所一度も測定が止まる様なことはありませんでした。</p>

<p>Bの方だとひどいときは週に2回位起こってましたし、買った直後からも起こっていたので
全然違います。</p>

<p>Bの方がたまたま不良品だったのか、偽物を掴まされたのかは分かりませんが、
やはり毎週測定が止まるようなことは異常だったようです。</p>

<p>同時に測定できないので精度や比較をするのは難しいですが、
人がいる環境で締め切っていると1000ppmを超えてきたり、
窓を開けると400ppmまで下がったり大体同じ様な動作になっていると思います。</p>

<p>外気で400ppmとして
何度か外でマニュアルキャリブレーションをしてるのですが、
Cは実際に400ppm以下の表示は出ないようになっていました。</p>

<p>外気は人が住んでるよ言うなところだと400ppmよりは50~100ppmくらい高い様な感じですが、
まあ正確にキャリブレーションするのも大変なので誤差+/-100ppm位は許容するということで。</p>

<blockquote>
  <p><a href="https://ds.data.jma.go.jp/ghg/kanshi/obs/co2_monthave_ryo.html">気象庁 二酸化炭素濃度の観測結果</a></p>
</blockquote>

<p>とりあえずちょくちょくつなげ直す様なことはなくなってよかったです。</p>

<p>MH-Z19BはAmazonでもAliExpressでも出どころが確実なところがありませんが、
MH-Z19Cであれば秋月電子通商で売ってるので今であればMH-Z19C
の方が安心かとは思いました。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[tsd2gspread: 時系列データをGoogle Sheetsに書き込むPythonツール]]></title>
    <link href="https://rcmdnk.com/blog/2021/04/13/computer-iot-raspberrypi-google/"/>
    <updated>2021-04-13T00:00:00+00:00</updated>
    <id>https://rcmdnk.com/blog/2021/04/13/computer-iot-raspberrypi-google</id>
    <content type="html"><![CDATA[<div class="amazon-img">
  <a href="//www.amazon.co.jp/gp/product/B00KNRL068?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B00KNRL068&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank"><img src="https://images-na.ssl-images-amazon.com/images/I/51EQHQnIMUL._SS200_.jpg" alt="現場ですぐ使える時系列データ分析～データサイエンティストのための基礎知識～" /></a>
</div>

<p>Raspberry Piから色々Google Sheetsに書き込むことが多くなってきたので、
ちょっと機能をまとめたツール的なものをつくってみました。</p>

<!-- more -->

<ul id="markdown-toc">
  <li><a href="#tsd2gspread" id="markdown-toc-tsd2gspread">tsd2gspread</a></li>
  <li><a href="#使い方" id="markdown-toc-使い方">使い方</a>    <ul>
      <li><a href="#ツールとして使う" id="markdown-toc-ツールとして使う">ツールとして使う</a></li>
      <li><a href="#親クラスとして使う" id="markdown-toc-親クラスとして使う">親クラスとして使う</a></li>
    </ul>
  </li>
  <li><a href="#主なパラメーターなど" id="markdown-toc-主なパラメーターなど">主なパラメーターなど</a></li>
</ul>
<div class="group"></div>

<div class="center_wrapper">
  <div>
  <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3802317723662375" data-ad-slot="5762198341"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  </div>
</div>

<h2 id="tsd2gspread">tsd2gspread</h2>

<div class="github-widget" data-repo="rcmdnk/tsd2gspread"></div>

<p>Pythonのツールで、pipで</p>

<pre><code>$ pip install tsd2gspread
</code></pre>

<p>で入れられます。</p>

<p>Google Sheetsに関しては、Pythonでは<a href="https://github.com/burnash/gspread">gspread</a>
という便利なツールがあって、これを使うと簡単にGoogle SheetsのAPIを使えます。</p>

<p>tsd2gspreadはこのgspreadを使って時系列データを書き込むのに特化したツールです。</p>

<p>gspredをそのまま使っても良かったのですが、別のデータの書き込みに重複部分が増えてきたので
まとめました。</p>

<h2 id="使い方">使い方</h2>

<h3 id="ツールとして使う">ツールとして使う</h3>

<p>まず、Google Sheets APIにアクセス出来るようサービスアカウントを作成してアカウント情報の入った
jsonファイルを取得します。</p>

<blockquote>
  <p><a href="https://gspread.readthedocs.io/en/latest/oauth2.html#for-bots-using-service-account">Authentication — gspread 3.7.0 documentation</a>.</p>
</blockquote>

<p>これを<strong>~/service_account.json</strong>などに置いておいて、
以下の様なスクリプトを実行します。</p>

<figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span></span><span class="kn">import</span> <span class="nn">tsd2gspread</span>
</span><span class="line">
</span><span class="line"><span class="n">tg</span> <span class="o">=</span> <span class="n">tsd2gspread</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span class="line">    <span class="n">service_account</span><span class="o">=</span><span class="s1">&#39;~/service_account.json&#39;</span><span class="p">,</span>
</span><span class="line">    <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;MySheet&#39;</span><span class="p">,</span>
</span><span class="line">    <span class="n">create</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span class="line">    <span class="n">worksheet_name</span><span class="o">=</span><span class="s1">&#39;MyWork&#39;</span><span class="p">,</span>
</span><span class="line">    <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;foo,bar,</span>
</span><span class="line">    <span class="n">share</span><span class="o">=</span><span class="s1">&#39;rcmdnk@gmail.com&#39;</span><span class="p">)</span>
</span><span class="line">
</span><span class="line"><span class="c1"># Make function to get data</span>
</span><span class="line"><span class="k">def</span> <span class="nf">get_data</span><span class="p">():</span>
</span><span class="line">    <span class="n">foo</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class="line">    <span class="n">bar</span> <span class="o">=</span> <span class="mi">2</span>
</span><span class="line">    <span class="k">return</span> <span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="p">)</span>
</span><span class="line">
</span><span class="line"><span class="c1"># Set data getter</span>
</span><span class="line"><span class="n">tg</span><span class="o">.</span><span class="n">get_data</span> <span class="o">=</span> <span class="n">get_data</span>
</span><span class="line">
</span><span class="line"><span class="c1"># Write Time Series Data to Google Sheets</span>
</span><span class="line"><span class="n">tg</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>

<p>これで、
<strong>MySheet</strong>という名前で以下の様な内容を持った
ワークシート名が<strong>MyWork</strong>のSheetsが出来ます。</p>

<table>
  <thead>
    <tr>
      <th>datetime</th>
      <th>foo</th>
      <th>bar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2021-01-02 03:04:05</td>
      <td>1</td>
      <td>2</td>
    </tr>
  </tbody>
</table>

<p>あとは<code>tg.write()</code>を実行するたびに、その実行時間と値が書き込まれていきます。</p>

<p>実際に使う際には、この<code>get_data</code>関数を適時必要なものにして渡して、
データを取得したいタイミングで<code>tg.write()</code>を実行すればOK。</p>

<p>この例ではSheetsがない場合には作成して書き込みを行っていますが、
その場合はサービスアカウントがオーナーとなってしまい、
そのアカウントを作ったユーザー自体がアクセス権限を持ってない状態で作られるので、
<code>share</code>で自分のアカウントを指定して自分がアクセスできるようにしてください。</p>

<pre><code>sheet_name='MySheet',
</code></pre>

<p>の代わりに既存のSheetsのURLを<code>sheet_url</code>で指定したり
Key(URLの中にあるランダムな文字列)を<code>sheet_key</code>で指定することも出来ます。</p>

<p>この場合はSheets側で<strong>共有</strong>から、上で取得したサービスアカウントファイルの中にある
<code>client_email</code>の値に対して編集権限で共有をしておく必要があります。</p>

<p>指定の名前のSheetsがすでにあり、共有設定されていれば上のように名前で指定しても
既存のファイルに書き込まれます。</p>

<h3 id="親クラスとして使う">親クラスとして使う</h3>

<p>Tsd2Gspreadというクラスがあるので、それを継承する形で使うことも出来ます。</p>

<figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span></span><span class="kn">from</span> <span class="nn">tsd2gspread</span> <span class="kn">import</span> <span class="n">Tsd2Gspread</span>
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Tsd2Gspread</span><span class="p">):</span>
</span><span class="line">    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="n">foo</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class="line">        <span class="n">bar</span> <span class="o">=</span> <span class="mi">2</span>
</span><span class="line">        <span class="k">return</span> <span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="p">)</span>
</span><span class="line">
</span><span class="line"><span class="n">tg</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">(</span>
</span><span class="line">    <span class="n">service_account</span><span class="o">=</span><span class="s1">&#39;~/service_account.json&#39;</span><span class="p">,</span>
</span><span class="line">    <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;MySheet&#39;</span><span class="p">,</span>
</span><span class="line">    <span class="n">create</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span class="line">    <span class="n">worksheet_name</span><span class="o">=</span><span class="s1">&#39;MyWork&#39;</span><span class="p">,</span>
</span><span class="line">    <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;foo,bar,</span>
</span><span class="line">    <span class="n">share</span><span class="o">=</span><span class="s1">&#39;rcmdnk@gmail.com&#39;</span><span class="p">)</span>
</span><span class="line">
</span><span class="line"><span class="c1"># Write Time Series Data to Google Sheets</span>
</span><span class="line"><span class="n">tg</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>

<p>基本的に定義すべきな関数は<code>get_data</code>で、
ここで書き込むべき変数を配列なりタプルなりで返す様にします。</p>

<p>これでそのクラスのインスタンスを作って<code>write</code>してあげれば書き込めます。</p>

<h2 id="主なパラメーターなど">主なパラメーターなど</h2>

<p><code>tsd2gspread.get</code>なり<code>Tsd2gspread</code>に渡せるパラメーターについて。</p>

<ul>
  <li><code>sheet_name</code>, <code>sheet_url</code>, <code>sheet_key</code>: Sheetsを名前かURLかSheetsのKeyで指定できます。新たに作る場合には<code>sheet_name</code>のみが使えます。</li>
  <li><code>columns</code>: 最初にSheetsを新たに作成する場合には<code>columns</code>に<code>,</code>で分けたカラム名を渡すことで
カラム名を1行目に書き込むことが出来ます。</li>
  <li><code>timedelta</code>: デフォルトではUTCの時間を書き込みます。これを日本時間に変更したい場合には<code>timedelta=9</code>などとしてUTCとの差を入れる必要があります。</li>
</ul>

<p>他にも色々とパラメーターはありますが、これらを<code>config_file</code>というパラメーターにファイルを渡すことでまとめて渡す事もできます。
<code>config_file</code>の中身は</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class=""><span class="line">sheet_name=MySheet
</span><span class="line">columns=foo,bar
</span><span class="line">...</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>みたいに<code>OPTION=VALUE</code>の様に書いておきます。</p>

<p>その他詳細は<a href="https://github.com/rcmdnk/tsd2gspread">README</a>で。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[シャープCOCORO AIRとGoogle Homeの連携]]></title>
    <link href="https://rcmdnk.com/blog/2021/04/12/computer-iot-google/"/>
    <updated>2021-04-12T00:00:00+00:00</updated>
    <id>https://rcmdnk.com/blog/2021/04/12/computer-iot-google</id>
    <content type="html"><![CDATA[<div class="app-img">
  <a href="//itunes.apple.com/jp/app//Sharp?at=10lc94" rel="nofollow" target="_blank"><img src="https://is3-ssl.mzstatic.com/image/thumb/Purple114/v4/48/5b/fc/485bfc18-a9b0-ca1a-54b6-dfca635275a1/AppIcon-0-0-1x_U007emarketing-0-0-0-3-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/200x200bb.jpg" alt="COCORO AIR" /></a>
</div>

<p>シャープの家電と連携するクラウドサービスCOCORO AIRが
Google Homeと連携できる、ということを今更ながら気づいたのでちょっと連携してみた感想。</p>

<!-- more -->

<ul id="markdown-toc">
  <li><a href="#シャープの家電" id="markdown-toc-シャープの家電">シャープの家電</a></li>
  <li><a href="#google-homeと連携" id="markdown-toc-google-homeと連携">Google Homeと連携</a></li>
  <li><a href="#連携して使えること" id="markdown-toc-連携して使えること">連携して使えること</a></li>
  <li><a href="#まとめ" id="markdown-toc-まとめ">まとめ</a></li>
</ul>
<div class="group"></div>

<div class="center_wrapper">
  <div>
  <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3802317723662375" data-ad-slot="5762198341"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  </div>
</div>

<h2 id="シャープの家電">シャープの家電</h2>

<p>ちょっと前にシャープの加湿空気清浄機を買いました。</p>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail"><div class="amazon-img">
  <a href="//www.amazon.co.jp/gp/product/B07JG3RZXR?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B07JG3RZXR&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank"><img src="https://images-na.ssl-images-amazon.com/images/I/61Mmz%2BqChqL._SS90_CR0,0,120,90_.jpg" alt="シャープ 加湿 空気清浄機 プラズマクラスター 25000 ハイグレード 13畳 / 空気清浄 23畳 2018年モデル グレー KI-JS50-H" /></a>
</div></div><a class="click_box_link" href="https://rcmdnk.com/blog/2021/01/25/life-iot-shopping/">加湿器調査: シャープの加湿空気清浄機KI-JS50購入(IoT)</a></div></li></ul>

<p>この機器は
<a href="https://cocoroplus.jp.sharp/air/">COCORO AIR</a>
というシャープのクラウドサービスに対応していて、
外出先からでも運転をON/OFFしたり運転状況を変えたりチェックしたり出来るものになっています。</p>

<p>ただ、API的なものは存在せず、スマホ以外から自動で操作するようなことは出来ないな、と思っていました。</p>

<p>そのあたりを何とかするため、以下の様なことを行ってスマホ以外からでも操作できるようにしてみました。</p>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail">
  <a href="https://rcmdnk.com/blog/2021/03/03/computer-iot-raspberrypi/"><img class="small-thumbnail-img" src="https://rcmdnk.com/images/post/thumbnail/20210303_switchon_120_90.jpg" width="120" height="90" alt="20210303_switchon_120_90" /></a>
</div><a class="click_box_link" href="https://rcmdnk.com/blog/2021/03/03/computer-iot-raspberrypi/">シャープの加湿空気清浄機をアプリ外から操作する</a></div></li></ul>

<ul class="post_card"><li class="index_click_box"><div class="group"><div class="title-small-thumbnail"><div class="amazon-img">
  <a href="//www.amazon.co.jp/gp/product/B07JG3RZXR?ie=UTF8&amp;camp=1207&amp;creative=8411&amp;creativeASIN=B07JG3RZXR&amp;linkCode=shr&amp;tag=rcmdnk0c-22" rel="nofollow" target="_blank"><img src="https://images-na.ssl-images-amazon.com/images/I/61Mmz%2BqChqL._SS90_CR0,0,120,90_.jpg" alt="シャープ 加湿 空気清浄機 プラズマクラスター 25000 ハイグレード 13畳 / 空気清浄 23畳 2018年モデル グレー KI-JS50-H" /></a>
</div></div><a class="click_box_link" href="https://rcmdnk.com/blog/2021/03/04/computer-iot-raspberrypi/">Raspberry Piからシャープの加湿空気清浄機を操作する</a></div></li></ul>

<p>これでRaspberry Piから操作できるので、後はIFTTTなりなんなりを使って好きなように操作できるようになっています。</p>

<h2 id="google-homeと連携">Google Homeと連携</h2>

<p>上みたいなことをやりたい理由の1つとして、Google Homeとの連携がありました。</p>

<p>が、今更気づいたこととして、COCORO AIRはGoogle Homeと直接連携することが可能でした。</p>

<blockquote>
  <p><a href="https://cocoroplus.jp.sharp/support/googleassistant/">Google アシスタント対応スピーカー  COCORO+（ココロプラス）  SHARP（シャープ）のスマート家電向けサービス</a></p>
</blockquote>

<ul>
  <li>Google Home</li>
  <li>Amazon Alexa</li>
  <li>LINE Clova</li>
</ul>

<p>との連携が可能、とのこと。</p>

<p>Google HomeのアプリでCOCORO AIRを探すとあって、連携が出来ます。</p>

<p>実際には、今回Google Homeのアプリを立ち上げた際に、COCORO AIRとの連携をしませんか?
的なポップアップが出てて連携した感じです。</p>

<p>最近連携できるようになったのかな?とも思ったのですが、連携自体はCOCORO AIRが出来た頃?から?
少なくとも2018年とかには出来ていた様です。</p>

<h2 id="連携して使えること">連携して使えること</h2>

<p>実際に連携してどのように使えるか使ってみました。</p>

<p>今あるのは加湿空気清浄機KI-JS50ですが、
COCORO AIRで登録してある名前(<code>JS50</code>としている)としてGoogle Homeに登録されていました。</p>

<p>これに対して、</p>

<ul>
  <li>JS50を止めて</li>
</ul>

<p>というとすぐに止まりました。
Raspberry Piを通して行うよりも速いです。</p>

<p>これを実行すると、スマホに、<strong>外部サービスからの操作がありました</strong>という通知がCOCORO AIRからされるようにっっています。</p>

<ul>
  <li>JS50をつけて</li>
</ul>

<p>というと、一旦</p>

<pre><code>JS50をスイッチオン、この操作を実行してもよろしいですか
</code></pre>

<p>と聞かれます。これに対して、<strong>はい</strong>と答えるとスイッチが点きました。</p>

<p>ただ、この返答がなかなかちゃんと反応してくれなくて、2回聞かれることもよくあり、
2回目に答えてもちゃんと反応してくれないことも。</p>

<p>これ以外に、</p>

<ul>
  <li>JS50、おまかせにして</li>
</ul>

<p>とするとモードの変更もできました。</p>

<p>ただ、他の、<strong>自動</strong>、や<strong>静音</strong>、<strong>強</strong>などは
<code>ジドウ</code>、<code>セイオン</code>、<code>シズカニ</code>、<code>キョウ</code>、<code>ツヨク</code>、
などしてもだめで、なぜか<code>スイッチオン、この操作を実行してもよろしいですか</code>
が出たり出なかったり。</p>

<p>加湿のON/OFFも出来るそうなんですが上手くいかず。</p>

<p>スイッチオン、もなんか聞かれるし、手元にスマホがあるならアプリからやった方が
ストレスなく変更できるな、というのが素直な感想でした。。。</p>

<h2 id="まとめ">まとめ</h2>

<p>Google HomeとCOCORO AIRが連携できることを見逃していましたが、
COCORO AIRのトップページからはどう行ったらたどり着けるのかよくわからず、
直接検索しないと分からないのでは、と(多分ちゃんと探せばあるのかなと思いますが、
見つけられなかった。。。)</p>

<p>使い勝手としては、止める分には割と良いんですが、
つけるのに何故か一度聞かれる、という仕様。</p>

<p>加えて(日本語が悪いのかもしれませんが)モード変更などがあまりうまく認識してくれません。</p>

<p>Raspberry Piで直接スマホの信号を使うのに比べると、
まず圧倒的に簡単、という点があり、反応速度も速い、という利点はありますが、
消すこと以外にはちょっと使い勝手が悪い感じがしています。</p>

]]></content>
  </entry>
  
</feed>
